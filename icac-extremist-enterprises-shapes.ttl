@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix gufo: <http://purl.org/nemo/gufo#> .
@prefix uco-core: <https://ontology.unifiedcyberontology.org/uco/core/> .
@prefix uco-identity: <https://ontology.unifiedcyberontology.org/uco/identity/> .
@prefix uco-observable: <https://ontology.unifiedcyberontology.org/uco/observable/> .
@prefix uco-action: <https://ontology.unifiedcyberontology.org/uco/action/> .
@prefix icac-enterprises: <https://ontology.unifiedcyberontology.org/icac/extremist-enterprises#> .

# =============================================================================
# GUFO TYPE VALIDATION SHAPES
# =============================================================================

icac-enterprises:GufoKindValidationShape rdf:type sh:NodeShape ;
    sh:targetClass gufo:Kind ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue owl:Class ;
        sh:minCount 1 ;
        sh:message "gUFO Kinds must be OWL classes."@en ;
    ] .

icac-enterprises:GufoRoleValidationShape rdf:type sh:NodeShape ;
    sh:targetClass gufo:Role ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue owl:Class ;
        sh:minCount 1 ;
        sh:message "gUFO Roles must be OWL classes."@en ;
    ] .

icac-enterprises:GufoEventTypeValidationShape rdf:type sh:NodeShape ;
    sh:targetClass gufo:EventType ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue owl:Class ;
        sh:minCount 1 ;
        sh:message "gUFO Event Types must be OWL classes."@en ;
    ] .

# =============================================================================
# GUFO TEMPORAL VALIDATION SHAPES
# =============================================================================

icac-enterprises:GufoTemporalConsistencyShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:property [
        sh:path icac-enterprises:hasOperationalBeginDate ;
        sh:datatype xsd:dateTimeStamp ;
        sh:maxCount 1 ;
        sh:message "Enterprise must have at most one operational begin date."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:hasOperationalEndDate ;
        sh:datatype xsd:dateTimeStamp ;
        sh:maxCount 1 ;
        sh:message "Enterprise must have at most one operational end date."@en ;
    ] ;
    sh:sparql [
        sh:message "Operational end date must be after begin date."@en ;
        sh:prefixes icac-enterprises: ;
        sh:select """
            SELECT $this WHERE {
                $this icac-enterprises:hasOperationalBeginDate ?begin .
                $this icac-enterprises:hasOperationalEndDate ?end .
                FILTER (?end <= ?begin)
            }
        """ ;
    ] .

icac-enterprises:GufoEventTemporalShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:SelfHarmCoercion ;
    sh:property [
        sh:path icac-enterprises:hasCoercionEventBeginDate ;
        sh:datatype xsd:dateTimeStamp ;
        sh:maxCount 1 ;
        sh:message "Coercion event must have at most one begin date."@en ;
    ] .

# =============================================================================
# GUFO PART-WHOLE VALIDATION SHAPES  
# =============================================================================

icac-enterprises:GufoComponentValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:NihilisticViolentExtremismNetwork ;
    sh:property [
        sh:path icac-enterprises:hasNetworkComponent ;
        sh:class gufo:Object ;
        sh:message "Network components must be gUFO Objects."@en ;
    ] .

icac-enterprises:GufoMembershipValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:property [
        sh:path icac-enterprises:hasMember ;
        sh:class uco-identity:Person ;
        sh:minCount 2 ; # Enterprise must have multiple participants
        sh:message "Enterprise must have at least 2 members."@en ;
    ] .

# =============================================================================
# GUFO QUALITY AND MODE VALIDATION SHAPES
# =============================================================================

icac-enterprises:GufoQualityValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:NihilisticViolentExtremismNetwork ;
    sh:property [
        sh:path icac-enterprises:hasNetworkNotorietyQuality ;
        sh:class gufo:Quality ;
        sh:maxCount 1 ;
        sh:message "Network can have at most one notoriety quality."@en ;
    ] .

icac-enterprises:GufoModeValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:EncryptedChannelNetwork ;
    sh:property [
        sh:path icac-enterprises:hasEncryptionCapability ;
        sh:class gufo:IntrinsicMode ;
        sh:maxCount 1 ;
        sh:message "Encrypted network can have at most one encryption capability mode."@en ;
    ] .

# =============================================================================
# GUFO SITUATION VALIDATION SHAPES
# =============================================================================

icac-enterprises:GufoSituationValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:property [
        sh:path icac-enterprises:operatesInSituation ;
        sh:class gufo:Situation ;
        sh:message "Enterprise must operate in valid gUFO Situations."@en ;
    ] .

icac-enterprises:GufoVictimizationSituationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:SelfHarmCoercion ;
    sh:property [
        sh:path icac-enterprises:createsVictimizationSituation ;
        sh:class gufo:Situation ;
        sh:minCount 1 ;
        sh:message "Self-harm coercion must create at least one victimization situation."@en ;
    ] .

# =============================================================================
# GUFO RELATOR VALIDATION SHAPES
# =============================================================================

icac-enterprises:GufoRelatorValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:property [
        sh:path icac-enterprises:hasLeadershipRelation ;
        sh:class gufo:Relator ;
        sh:minCount 1 ;
        sh:message "Enterprise must have at least one leadership relator."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:hasExploitationRelation ;
        sh:class gufo:Relator ;
        sh:minCount 1 ;
        sh:message "Exploitation enterprise must have at least one exploitation relator."@en ;
    ] .

# =============================================================================
# GUFO PARTICIPATION VALIDATION SHAPES
# =============================================================================

icac-enterprises:GufoParticipationValidationShape rdf:type sh:NodeShape ;
    sh:targetClass uco-identity:Person ;
    sh:property [
        sh:path icac-enterprises:participatesInCoercion ;
        sh:class icac-enterprises:SelfHarmCoercion ;
        sh:message "Person participation in coercion must link to valid coercion events."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:participatesInRecruitment ;
        sh:class icac-enterprises:ContentBasedRecruitment ;
        sh:message "Person participation in recruitment must link to valid recruitment events."@en ;
    ] .

# =============================================================================
# ENHANCED EXISTING SHAPES WITH GUFO INTEGRATION
# =============================================================================

# =============================================================================
# NIHILISTIC VIOLENT EXTREMISM NETWORK SHAPES
# =============================================================================

icac-enterprises:NihilisticViolentExtremismNetworkShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:NihilisticViolentExtremismNetwork ;
    sh:property [
        sh:path icac-enterprises:networkSize ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 2 ; # Minimum 2 members for a network
        sh:message "NVE network must have at least 2 members."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:operationalScope ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("local" "national" "international") ;
        sh:message "Operational scope must be local, national, or international."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:ideologicalFramework ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("nihilistic" "accelerationist" "anarchist" "mixed") ;
        sh:message "Ideological framework must be recognized extremist ideology."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:networkNotoriety ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("low" "moderate" "high" "international") ;
        sh:message "Network notoriety must be valid level."@en ;
    ] .

icac-enterprises:ChildExploitationEnterpriseShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:property [
        sh:path icac-enterprises:leadershipCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ; # Must have at least 1 leader
        sh:maxInclusive 10 ; # Reasonable upper bound
        sh:message "Enterprise must have 1-10 leaders."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:membershipRequirements ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:minLength 10 ;
        sh:maxLength 500 ;
        sh:message "Membership requirements must be 10-500 characters."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:hasHierarchy ;
        sh:class icac-enterprises:EnterpriseHierarchy ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Enterprise must have exactly one hierarchy."@en ;
    ] .

# =============================================================================
# ENTERPRISE HIERARCHY SHAPES
# =============================================================================

icac-enterprises:EnterpriseHierarchyShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:EnterpriseHierarchy ;
    sh:property [
        sh:path icac-enterprises:hierarchyComplexity ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("simple" "moderate" "complex" "highly_complex") ;
        sh:message "Hierarchy complexity must be valid level."@en ;
    ] .

icac-enterprises:InnerCoreShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:InnerCore ;
    sh:property [
        sh:path icac-enterprises:innerCoreSize ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ; # Must have at least 1 member
        sh:maxInclusive 50 ; # Reasonable upper bound for inner core
        sh:message "Inner core must have 1-50 members."@en ;
    ] .

icac-enterprises:MembershipTierShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:MembershipTier ;
    sh:property [
        sh:path icac-enterprises:membershipLevel ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("novice" "member" "advanced" "inner_core" "leader") ;
        sh:message "Membership level must be valid tier."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:accessLevel ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("restricted" "basic" "enhanced" "privileged" "full") ;
        sh:message "Access level must be valid level."@en ;
    ] .

# =============================================================================
# CONTENT COMPILATION SHAPES
# =============================================================================

icac-enterprises:LorebookShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:Lorebook ;
    sh:property [
        sh:path icac-enterprises:contentVolumeItems ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ; # Must contain at least 1 item
        sh:maxInclusive 10000 ; # Reasonable upper bound
        sh:message "Lorebook must contain 1-10,000 items."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:compilationComplexity ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("basic" "moderate" "advanced" "professional") ;
        sh:message "Compilation complexity must be valid level."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:contentNotoriety ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("low" "moderate" "high" "notorious") ;
        sh:message "Content notoriety must be valid level."@en ;
    ] .

icac-enterprises:ContentEditingProcessShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ContentEditingProcess ;
    sh:property [
        sh:path icac-enterprises:editingQuality ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("poor" "basic" "good" "professional") ;
        sh:message "Editing quality must be valid level."@en ;
    ] .

icac-enterprises:ContentValueAssessmentShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ContentValueAssessment ;
    sh:property [
        sh:path icac-enterprises:contentValue ;
        sh:datatype xsd:decimal ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 10.0 ; # 0-10 value scale
        sh:message "Content value must be between 0.0 and 10.0."@en ;
    ] .

# =============================================================================
# CONTENT CURRENCY SYSTEM SHAPES
# =============================================================================

icac-enterprises:ContentCurrencySystemShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ContentCurrencySystem ;
    sh:property [
        sh:path icac-enterprises:usesAsCurrency ;
        sh:class icac-enterprises:Lorebook ;
        sh:minCount 1 ; # Must use at least one piece of content as currency
        sh:message "Content currency system must use at least one lorebook as currency."@en ;
    ] .

icac-enterprises:MembershipAdvancementSystemShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:MembershipAdvancementSystem ;
    sh:property [
        sh:path icac-enterprises:advancementCriteria ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:minLength 10 ;
        sh:maxLength 500 ;
        sh:message "Advancement criteria must be 10-500 characters."@en ;
    ] .

# =============================================================================
# SELF-HARM COERCION SHAPES
# =============================================================================

icac-enterprises:SelfHarmCoercionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:SelfHarmCoercion ;
    sh:property [
        sh:path icac-enterprises:coercionSeverity ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("moderate" "severe" "extreme" "life_threatening") ;
        sh:message "Coercion severity must be valid level."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:selfHarmType ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("cutting" "burning" "bruising" "other") ;
        sh:message "Self-harm type must be valid type."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:coercionEffectiveness ;
        sh:datatype xsd:decimal ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:message "Coercion effectiveness must be between 0.0 and 1.0."@en ;
    ] .

icac-enterprises:ExtremeDegradationCoercionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ExtremeDegradationCoercion ;
    sh:property [
        sh:path icac-enterprises:degradationLevel ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("moderate" "severe" "extreme" "inhuman") ;
        sh:message "Degradation level must be valid level."@en ;
    ] .

# =============================================================================
# VULNERABILITY TARGETING SHAPES
# =============================================================================

icac-enterprises:VulnerablePopulationTargetingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:VulnerablePopulationTargeting ;
    sh:property [
        sh:path icac-enterprises:vulnerabilityType ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("mental_health" "isolation" "trauma" "substance_abuse" "financial" "social") ;
        sh:message "Vulnerability type must be valid type."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:targetingPrecision ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("broad" "focused" "precise" "surgical") ;
        sh:message "Targeting precision must be valid level."@en ;
    ] .

icac-enterprises:SocialEngineeringCampaignShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:SocialEngineeringCampaign ;
    sh:property [
        sh:path icac-enterprises:socialEngineeringComplexity ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("basic" "intermediate" "advanced" "sophisticated") ;
        sh:message "Social engineering complexity must be valid level."@en ;
    ] .

icac-enterprises:TrustBuildingProcessShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:TrustBuildingProcess ;
    sh:property [
        sh:path icac-enterprises:trustBuildingDuration ;
        sh:datatype xsd:decimal ;
        sh:maxCount 1 ;
        sh:minInclusive 0.1 ; # Minimum 0.1 days (about 2.4 hours)
        sh:maxInclusive 365.0 ; # Maximum 1 year
        sh:message "Trust building duration must be between 0.1 and 365 days."@en ;
    ] .

# =============================================================================
# CROSS-PLATFORM COORDINATION SHAPES
# =============================================================================

icac-enterprises:CrossPlatformCoordinationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:CrossPlatformCoordination ;
    sh:property [
        sh:path icac-enterprises:platformCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 2 ; # Must coordinate across at least 2 platforms
        sh:maxInclusive 20 ; # Reasonable upper bound
        sh:message "Cross-platform coordination must involve 2-20 platforms."@en ;
    ] .

icac-enterprises:EncryptedChannelNetworkShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:EncryptedChannelNetwork ;
    sh:property [
        sh:path icac-enterprises:encryptionLevel ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("basic" "strong" "military_grade") ;
        sh:message "Encryption level must be valid level."@en ;
    ] ;
    sh:property [
        sh:path icac-enterprises:channelCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ; # Must have at least 1 channel
        sh:maxInclusive 100 ; # Reasonable upper bound
        sh:message "Encrypted network must have 1-100 channels."@en ;
    ] .

icac-enterprises:AlternateAccountSystemShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:AlternateAccountSystem ;
    sh:property [
        sh:path icac-enterprises:altAccountCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ; # Must have at least 1 alt account
        sh:maxInclusive 50 ; # Reasonable upper bound per member
        sh:message "Alt account system must have 1-50 accounts per member."@en ;
    ] .

# =============================================================================
# INVESTIGATION SHAPES
# =============================================================================

icac-enterprises:CovertEmployeeOperationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:CovertEmployeeOperation ;
    sh:property [
        sh:path icac-enterprises:evidenceQuality ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("poor" "fair" "good" "excellent") ;
        sh:message "Evidence quality must be valid level."@en ;
    ] .

icac-enterprises:EncryptedChannelInfiltrationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:EncryptedChannelInfiltration ;
    sh:property [
        sh:path icac-enterprises:infiltrationDuration ;
        sh:datatype xsd:decimal ;
        sh:maxCount 1 ;
        sh:minInclusive 1.0 ; # Minimum 1 day
        sh:maxInclusive 1095.0 ; # Maximum 3 years
        sh:message "Infiltration duration must be between 1 and 1,095 days."@en ;
    ] .

icac-enterprises:IdentityCorrelationAnalysisShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:IdentityCorrelationAnalysis ;
    sh:property [
        sh:path icac-enterprises:identityCorrelationAccuracy ;
        sh:datatype xsd:decimal ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:message "Identity correlation accuracy must be between 0.0 and 1.0."@en ;
    ] .

icac-enterprises:NetworkMappingInvestigationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:NetworkMappingInvestigation ;
    sh:property [
        sh:path icac-enterprises:networkMappingCompleteness ;
        sh:datatype xsd:decimal ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:message "Network mapping completeness must be between 0.0 and 1.0."@en ;
    ] .

# =============================================================================
# RELATIONSHIP VALIDATION SHAPES
# =============================================================================

icac-enterprises:EnterpriseLeadershipValidationShape rdf:type sh:NodeShape ;
    sh:targetNode icac-enterprises:EnterpriseLeaderRole ;
    sh:property [
        sh:path [ sh:inversePath icac-enterprises:holdsLeadershipRole ] ;
        sh:class uco-identity:Person ;
        sh:minCount 1 ;
        sh:message "Enterprise leader role must be held by at least one person."@en ;
    ] .

icac-enterprises:LorebookContentValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:Lorebook ;
    sh:property [
        sh:path icac-enterprises:containsVictimContent ;
        sh:class uco-observable:ObservableObject ;
        sh:minCount 1 ;
        sh:message "Lorebook must contain at least one piece of victim content."@en ;
    ] .

icac-enterprises:InnerCoreAccessValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:InnerCore ;
    sh:property [
        sh:path [ sh:inversePath icac-enterprises:participatesInInnerCore ] ;
        sh:class uco-identity:Person ;
        sh:minCount 1 ;
        sh:message "Inner core must have at least one participating member."@en ;
    ] .

# =============================================================================
# CROSS-VALIDATION SHAPES
# =============================================================================

icac-enterprises:NetworkSizeConsistencyShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:NihilisticViolentExtremismNetwork ;
    sh:sparql [
        sh:message "Network size must be consistent with inner core size and leadership count."@en ;
        sh:prefixes icac-enterprises: ;
        sh:select """
            SELECT $this WHERE {
                $this icac-enterprises:networkSize ?networkSize .
                $this icac-enterprises:operatesEnterprise ?enterprise .
                ?enterprise icac-enterprises:hasInnerCore ?innerCore .
                ?innerCore icac-enterprises:innerCoreSize ?innerCoreSize .
                ?enterprise icac-enterprises:leadershipCount ?leadershipCount .
                FILTER (?networkSize < (?innerCoreSize + ?leadershipCount))
            }
        """ ;
    ] .

icac-enterprises:CoercionSeverityConsistencyShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:SelfHarmCoercion ;
    sh:sparql [
        sh:message "Extreme coercion severity must have degradation level of severe or extreme."@en ;
        sh:prefixes icac-enterprises: ;
        sh:select """
            SELECT $this WHERE {
                $this icac-enterprises:coercionSeverity "extreme" .
                $this rdf:type/rdfs:subClassOf* icac-enterprises:ExtremeDegradationCoercion .
                $this icac-enterprises:degradationLevel ?degradationLevel .
                FILTER (?degradationLevel NOT IN ("severe", "extreme", "inhuman"))
            }
        """ ;
    ] .

icac-enterprises:PlatformCoordinationConsistencyShape rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:CrossPlatformCoordination ;
    sh:sparql [
        sh:message "Platform count must be consistent with encrypted channel count."@en ;
        sh:prefixes icac-enterprises: ;
        sh:select """
            SELECT $this WHERE {
                $this icac-enterprises:platformCount ?platformCount .
                ?enterprise icac-enterprises:coordinatesAcrossPlatforms $this .
                ?enterprise icac-enterprises:utilizesEncryptedChannels ?encryptedNetwork .
                ?encryptedNetwork icac-enterprises:channelCount ?channelCount .
                FILTER (?channelCount < ?platformCount)
            }
        """ ;
    ] .

# =============================================================================
# BUSINESS RULE VALIDATION SHAPES
# =============================================================================

icac-enterprises:EnterpriseHierarchyBusinessRule rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:rule [
        sh:condition [
            sh:property [
                sh:path icac-enterprises:leadershipCount ;
                sh:minInclusive 3 ;
            ] ;
        ] ;
        sh:consequence [
            sh:property [
                sh:path icac-enterprises:hasHierarchy ;
                sh:hasValue icac-enterprises:LeadershipStructure ;
            ] ;
        ] ;
    ] ;
    sh:message "Enterprises with 3+ leaders must have formal leadership structure."@en .

icac-enterprises:ContentCurrencyBusinessRule rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ContentCurrencySystem ;
    sh:rule [
        sh:condition [
            sh:property [
                sh:path icac-enterprises:usesAsCurrency ;
                sh:minCount 5 ; # 5+ pieces of content as currency
            ] ;
        ] ;
        sh:consequence [
            sh:property [
                sh:path rdf:type ;
                sh:hasValue icac-enterprises:MembershipAdvancementSystem ;
            ] ;
        ] ;
    ] ;
    sh:message "Content currency systems with 5+ items must support membership advancement."@en .

icac-enterprises:InvestigationQualityBusinessRule rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:IdentityCorrelationAnalysis ;
    sh:rule [
        sh:condition [
            sh:property [
                sh:path icac-enterprises:identityCorrelationAccuracy ;
                sh:minInclusive 0.9 ; # 90%+ accuracy
            ] ;
        ] ;
        sh:consequence [
            sh:property [
                sh:path icac-enterprises:evidenceQuality ;
                sh:in ("good" "excellent") ;
            ] ;
        ] ;
    ] ;
    sh:message "High accuracy identity correlation (90%+) must produce good or excellent evidence quality."@en .

# =============================================================================
# GUFO FOUNDATIONAL CONSTRAINTS AND BUSINESS RULES
# =============================================================================

icac-enterprises:GufoKindIdentityBusinessRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Kind ;
    sh:sparql [
        sh:message "gUFO Kinds cannot be subclasses of other Kinds - violates identity principle."@en ;
        sh:prefixes gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type gufo:Kind .
                $this rdfs:subClassOf ?superKind .
                ?superKind rdf:type gufo:Kind .
                FILTER ($this != ?superKind)
            }
        """ ;
    ] .

icac-enterprises:GufoRoleAntiRigidityRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Role ;
    sh:sparql [
        sh:message "gUFO Roles are anti-rigid and cannot be essential to their instances."@en ;
        sh:prefixes gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type gufo:Role .
                $this rdfs:subClassOf ?kind .
                ?kind rdf:type gufo:Kind .
            }
        """ ;
    ] .

icac-enterprises:GufoEventTemporalExistenceRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Event ;
    sh:property [
        sh:path [ sh:alternativePath ( gufo:hasBeginPointInXSDDateTimeStamp icac-enterprises:hasCoercionEventBeginDate icac-enterprises:hasInvestigationBeginDate ) ] ;
        sh:minCount 1 ;
        sh:message "gUFO Events must have at least one temporal beginning point."@en ;
    ] .

icac-enterprises:GufoFunctionalComplexPartRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:FunctionalComplex ;
    sh:property [
        sh:path [ sh:alternativePath ( gufo:isComponentOf icac-enterprises:hasNetworkComponent icac-enterprises:hasMember ) ] ;
        sh:minCount 1 ;
        sh:message "gUFO Functional Complexes must have at least one component or member."@en ;
    ] .

icac-enterprises:GufoQualityInherentRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Quality ;
    sh:property [
        sh:path [ sh:inversePath [ sh:alternativePath ( gufo:hasQuality icac-enterprises:hasNetworkNotorietyQuality ) ] ] ;
        sh:class gufo:Object ;
        sh:minCount 1 ;
        sh:message "gUFO Qualities must inhere in at least one Object."@en ;
    ] .

icac-enterprises:GufoModeInherentRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:IntrinsicMode ;
    sh:property [
        sh:path [ sh:inversePath [ sh:alternativePath ( gufo:hasMode icac-enterprises:hasEncryptionCapability icac-enterprises:hasRecruitmentMode ) ] ] ;
        sh:class gufo:Object ;
        sh:minCount 1 ;
        sh:message "gUFO Intrinsic Modes must inhere in at least one Object."@en ;
    ] .

icac-enterprises:GufoSituationFactualRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Situation ;
    sh:sparql [
        sh:message "gUFO Situations must be factual and include at least one object or event."@en ;
        sh:prefixes gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type gufo:Situation .
                FILTER NOT EXISTS {
                    { ?object gufo:participatesIn $this . }
                    UNION
                    { ?event gufo:occursDuring $this . }
                    UNION  
                    { $this gufo:includesObject ?object . }
                    UNION
                    { $this gufo:includesEvent ?event . }
                }
            }
        """ ;
    ] .

icac-enterprises:GufoRelatorMediationRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Relator ;
    sh:sparql [
        sh:message "gUFO Relators must mediate relationships between at least two distinct objects."@en ;
        sh:prefixes gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type gufo:Relator .
                FILTER NOT EXISTS {
                    $this gufo:mediates ?obj1 .
                    $this gufo:mediates ?obj2 .
                    FILTER (?obj1 != ?obj2)
                }
            }
        """ ;
    ] .

# =============================================================================
# GUFO ENHANCED VALIDATION FOR ICAC ENTERPRISE PATTERNS
# =============================================================================

icac-enterprises:GufoEnterpriseStructureValidation rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:sparql [
        sh:message "Enterprise as functional complex must have proper part-whole relationships with its hierarchy."@en ;
        sh:prefixes icac-enterprises: , gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type icac-enterprises:ChildExploitationEnterprise .
                $this rdf:type gufo:FunctionalComplex .
                $this icac-enterprises:hasHierarchy ?hierarchy .
                FILTER NOT EXISTS {
                    ?hierarchy gufo:isComponentOf $this .
                }
            }
        """ ;
    ] .

icac-enterprises:GufoNetworkCellValidation rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ExtremistNetworkCell ;
    sh:sparql [
        sh:message "Network cells must be proper components of their parent network."@en ;
        sh:prefixes icac-enterprises: , gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type icac-enterprises:ExtremistNetworkCell .
                ?network icac-enterprises:hasNetworkCell $this .
                FILTER NOT EXISTS {
                    $this gufo:isComponentOf ?network .
                }
            }
        """ ;
    ] .

icac-enterprises:GufoCoercionEventValidation rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:SelfHarmCoercion ;
    sh:sparql [
        sh:message "Coercion events must create situations and involve participant objects."@en ;
        sh:prefixes icac-enterprises: , gufo: , uco-identity: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type icac-enterprises:SelfHarmCoercion .
                $this rdf:type gufo:Event .
                FILTER NOT EXISTS {
                    {
                        $this icac-enterprises:createsVictimizationSituation ?situation .
                        ?situation rdf:type gufo:Situation .
                    }
                    UNION
                    {
                        ?person uco-identity:Person .
                        ?person icac-enterprises:participatesInCoercion $this .
                    }
                }
            }
        """ ;
    ] .

icac-enterprises:GufoTemporalConsistencyValidation rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:ChildExploitationEnterprise ;
    sh:sparql [
        sh:message "Enterprise temporal boundaries must be consistent with member participation events."@en ;
        sh:prefixes icac-enterprises: , gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this icac-enterprises:hasOperationalBeginDate ?begin .
                $this icac-enterprises:hasOperationalEndDate ?end .
                $this icac-enterprises:hasMember ?member .
                ?member icac-enterprises:participatesInCoercion ?event .
                ?event icac-enterprises:hasCoercionEventBeginDate ?eventDate .
                FILTER (?eventDate < ?begin || ?eventDate > ?end)
            }
        """ ;
    ] .

icac-enterprises:GufoRoleInstantiationValidation rdf:type sh:NodeShape ;
    sh:targetClass icac-enterprises:EnterpriseRole ;
    sh:sparql [
        sh:message "Enterprise roles must be properly instantiated by persons within enterprise context."@en ;
        sh:prefixes icac-enterprises: , gufo: , uco-identity: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type icac-enterprises:EnterpriseRole .
                $this rdf:type gufo:Role .
                FILTER NOT EXISTS {
                    ?person rdf:type uco-identity:Person .
                    ?person ?roleProperty $this .
                    ?enterprise icac-enterprises:hasMember ?person .
                    ?enterprise rdf:type icac-enterprises:ChildExploitationEnterprise .
                }
            }
        """ ;
    ] .

# =============================================================================
# GUFO FOUNDATIONAL CARDINALITY CONSTRAINTS
# =============================================================================

icac-enterprises:GufoObjectExistenceRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Object ;
    sh:property [
        sh:path [ sh:alternativePath ( gufo:hasBeginPointInXSDDateTimeStamp gufo:hasEndPointInXSDDateTimeStamp ) ] ;
        sh:message "gUFO Objects should have temporal existence markers when applicable."@en ;
    ] .

icac-enterprises:GufoEventDurationRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Event ;
    sh:sparql [
        sh:message "gUFO Events with both begin and end dates must have positive duration."@en ;
        sh:prefixes gufo: ;
        sh:select """
            SELECT $this WHERE {
                $this rdf:type gufo:Event .
                $this gufo:hasBeginPointInXSDDateTimeStamp ?begin .
                $this gufo:hasEndPointInXSDDateTimeStamp ?end .
                FILTER (?end <= ?begin)
            }
        """ ;
    ] .

icac-enterprises:GufoCollectionMembershipRule rdf:type sh:NodeShape ;
    sh:targetClass gufo:Collection ;
    sh:property [
        sh:path [ sh:inversePath gufo:isCollectionMemberOf ] ;
        sh:minCount 1 ;
        sh:message "gUFO Collections must have at least one member."@en ;
    ] . 