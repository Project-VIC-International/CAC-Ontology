PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

PREFIX uco-action: <https://ontology.unifiedcyberontology.org/uco/action/>
PREFIX uco-core: <https://ontology.unifiedcyberontology.org/uco/core/>
PREFIX uco-identity: <https://ontology.unifiedcyberontology.org/uco/identity/>
PREFIX uco-observable: <https://ontology.unifiedcyberontology.org/uco/observable/>
PREFIX uco-types: <https://ontology.unifiedcyberontology.org/uco/types/>

PREFIX cacontology-platforms: <https://cacontology.projectvic.org/platforms#>
PREFIX cacontology-production: <https://cacontology.projectvic.org/production#>
PREFIX cacontology-infrastructure: <https://cacontology.projectvic.org/platform-infrastructure#>

# =============================================================================
# The Sun livestreamed CSEA (harm-minimized) â€” analytics suite
# Target KG:
#   examples_knowledge_graphs/thesun-livestreamed-csea-philippines-2026-example.ttl
# =============================================================================

#################################################################
# Q1: Source document + URL
#################################################################
SELECT ?doc ?label ?url WHERE {
  ?doc a uco-observable:ObservableObject ;
       rdfs:label ?label ;
       uco-core:hasFacet ?urlFacet .
  ?urlFacet a uco-observable:URLFacet ;
           uco-observable:url ?url .
}

#################################################################
# Q2: Source hashes
#################################################################
SELECT ?doc ?hashValue WHERE {
  ?doc a uco-observable:ObservableObject ;
       uco-core:hasFacet ?hashFacet .
  ?hashFacet a uco-observable:HashFacet ;
            uco-observable:hash ?hashNode .
  ?hashNode a uco-types:Hash ;
           uco-types:hashValue ?hashValue .
}

#################################################################
# Q3: List LiveProductionEvent nodes + streamingPlatform
#################################################################
SELECT ?event ?label ?platform ?desc WHERE {
  ?event a cacontology-production:LiveProductionEvent ;
         rdfs:label ?label ;
         cacontology-production:streamingPlatform ?platform ;
         uco-core:description ?desc .
}

#################################################################
# Q4: List payment processing nodes + paymentMethods
#################################################################
SELECT ?pp ?label ?method ?desc WHERE {
  ?pp a cacontology-infrastructure:PaymentProcessing ;
      rdfs:label ?label ;
      cacontology-infrastructure:paymentMethods ?method ;
      uco-core:description ?desc .
}

#################################################################
# Q5: List named messaging services referenced
#################################################################
SELECT ?svc ?label WHERE {
  ?svc a cacontology-platforms:MessagingService ;
       rdfs:label ?label .
}
ORDER BY ?label

#################################################################
# Q6: Statement actions and what they connect
#################################################################
SELECT ?action ?label ?obj ?objLabel WHERE {
  ?action a uco-action:Action ;
          rdfs:label ?label ;
          uco-action:object ?obj .
  OPTIONAL { ?obj rdfs:label ?objLabel . }
}
ORDER BY ?action ?obj

#################################################################
# Q7: Low-connectivity nodes (degree, excluding rdf:type)
#################################################################
SELECT ?node (COUNT(?pOut) + COUNT(?pIn) AS ?degree) WHERE {
  {
    ?node ?pOut ?o .
    FILTER(?pOut != rdf:type)
  }
  UNION
  {
    ?s ?pIn ?node .
    FILTER(?pIn != rdf:type)
  }
}
GROUP BY ?node
ORDER BY ?degree ?node

