@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix uco-core: <https://ontology.unifiedcyberontology.org/core#> .
@prefix uco-identity: <https://ontology.unifiedcyberontology.org/identity#> .
@prefix uco-action: <https://ontology.unifiedcyberontology.org/action#> .
@prefix uco-role: <https://ontology.unifiedcyberontology.org/role#> .
@prefix uco-observable: <https://ontology.unifiedcyberontology.org/observable#> .
@prefix uco-tool: <https://ontology.unifiedcyberontology.org/tool#> .
@prefix case-investigation: <https://ontology.caseontology.org/case/investigation#> .
@prefix icac: <https://ontology.unifiedcyberontology.org/icac#> .
@prefix icac-forensics: <https://ontology.unifiedcyberontology.org/icac/forensics#> .

# =============================================================================
# EXTENDED FORENSIC SHAPES FOR DIGITAL EVIDENCE
# This file extends the basic icac-forensics-shapes.ttl with comprehensive
# validation for digital evidence processing, analysis, and management
# =============================================================================

# =============================================================================
# FORENSIC IMAGE AND DIGITAL EVIDENCE SHAPES
# =============================================================================

icac-forensics:ForensicImageExtendedShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ForensicImage ;
    rdfs:label "Forensic Image Extended Shape"@en ;
    rdfs:comment "Extended validation shape for forensic image instances with comprehensive digital evidence requirements."@en ;
    sh:property [
        sh:path icac-forensics:acquisitionMethod ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "physical_imaging" "logical_imaging" "live_imaging" "chip_off" "jtag" "selective_imaging" ) ;
        sh:message "Forensic image must specify acquisition method from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-forensics:writeBlockingUsed ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Forensic image must specify if write blocking was used."@en
    ] ;
    sh:property [
        sh:path uco-core:sizeInBytes ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1000000000000.0 ;
        sh:message "Image size must be between 0 and 1TB (in bytes)."@en
    ] ;
    sh:property [
        sh:path uco-core:createdTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Forensic image must specify creation time."@en
    ] .

icac-forensics:RecoveredFileExtendedShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:RecoveredFile ;
    rdfs:label "Recovered File Extended Shape"@en ;
    rdfs:comment "Extended validation shape for recovered file instances."@en ;
    sh:property [
        sh:path icac-forensics:recoveryMethod ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "file_carving" "undelete_utility" "hex_editor" "specialized_software" "hardware_recovery" "manual_reconstruction" ) ;
        sh:message "Recovered file must specify recovery method from the allowed list."@en
    ] ;
    sh:property [
        sh:path uco-observable:fileName ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 1 ;
        sh:maxLength 255 ;
        sh:message "Recovered file must specify file name (1-255 characters)."@en
    ] ;
    sh:property [
        sh:path uco-observable:filePath ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 1 ;
        sh:maxLength 1000 ;
        sh:message "Recovered file must specify file path (1-1000 characters)."@en
    ] ;
    sh:property [
        sh:path uco-core:createdTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Recovered file may specify creation time."@en
    ] ;
    sh:property [
        sh:path uco-core:modifiedTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Recovered file may specify modification time."@en
    ] .

# =============================================================================
# MOBILE FORENSIC TOOL SHAPES
# =============================================================================

icac-forensics:MobileForensicToolExtendedShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:MobileForensicTool ;
    rdfs:label "Mobile Forensic Tool Extended Shape"@en ;
    rdfs:comment "Extended validation shape for mobile forensic tool instances."@en ;
    sh:property [
        sh:path uco-core:name ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 3 ;
        sh:maxLength 100 ;
        sh:message "Mobile forensic tool must specify name (3-100 characters)."@en
    ] ;
    sh:property [
        sh:path uco-tool:version ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 1 ;
        sh:maxLength 50 ;
        sh:message "Tool version should be 1-50 characters when provided."@en
    ] .

# =============================================================================
# FORENSIC ACQUISITION ACTION EXTENDED SHAPES
# =============================================================================

icac-forensics:ForensicAcquisitionActionExtendedShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ForensicAcquisitionAction ;
    rdfs:label "Forensic Acquisition Action Extended Shape"@en ;
    rdfs:comment "Extended validation shape for forensic acquisition action instances."@en ;
    sh:property [
        sh:path icac-forensics:acquisitionMethod ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "physical" "logical" "live" "chip_off" "jtag" "selective" ) ;
        sh:message "Forensic acquisition must specify acquisition method from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-forensics:writeBlockingUsed ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Forensic acquisition must specify if write blocking was used."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Forensic acquisition must specify start time."@en
    ] ;
    sh:property [
        sh:path uco-core:endTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Forensic acquisition may specify end time."@en
    ] .

# =============================================================================
# EVIDENCE VERIFICATION ACTION EXTENDED SHAPES
# =============================================================================

icac-forensics:EvidenceVerificationActionExtendedShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:EvidenceVerificationAction ;
    rdfs:label "Evidence Verification Action Extended Shape"@en ;
    rdfs:comment "Extended validation shape for evidence verification action instances."@en ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Evidence verification must specify verification time."@en
    ] ;
    sh:property [
        sh:path uco-action:usesTool ;
        sh:class uco-tool:Tool ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Evidence verification must specify verification tool used."@en
    ] .

# =============================================================================
# MASS DIGITAL EVIDENCE PROCESSING SHAPES
# =============================================================================

icac-forensics:MassDigitalEvidenceProcessingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:MassDigitalEvidenceProcessing ;
    rdfs:label "Mass Digital Evidence Processing Shape"@en ;
    rdfs:comment "Validation shape for mass digital evidence processing instances."@en ;
    sh:property [
        sh:path icac-forensics:evidenceVolumeTerabytes ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.001 ;
        sh:maxInclusive 10000.0 ;
        sh:message "Evidence volume must be between 0.001 and 10000 terabytes."@en
    ] ;
    sh:property [
        sh:path icac-forensics:filesProcessedMillions ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.001 ;
        sh:maxInclusive 1000.0 ;
        sh:message "Files processed must be between 0.001 and 1000 million."@en
    ] ;
    sh:property [
        sh:path icac-forensics:processingTimeframeDays ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 3650 ;
        sh:message "Processing timeframe must be between 1 and 3650 days (10 years)."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Mass processing must specify start time."@en
    ] .

icac-forensics:AutomatedContentAnalysisShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:AutomatedContentAnalysis ;
    rdfs:label "Automated Content Analysis Shape"@en ;
    rdfs:comment "Validation shape for automated content analysis instances."@en ;
    sh:property [
        sh:path icac-forensics:automationPercentage ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 100.0 ;
        sh:message "Automation percentage must be between 0.0 and 100.0."@en
    ] ;
    sh:property [
        sh:path icac-forensics:processingSpeed ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 1.0 ;
        sh:maxInclusive 1000000.0 ;
        sh:message "Processing speed must be between 1.0 and 1000000.0 files per hour."@en
    ] ;
    sh:property [
        sh:path icac-forensics:falsePositiveRate ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:message "False positive rate must be between 0.0 and 1.0."@en
    ] .

icac-forensics:EvidenceTriageSystemShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:EvidenceTriageSystem ;
    rdfs:label "Evidence Triage System Shape"@en ;
    rdfs:comment "Validation shape for evidence triage system instances."@en ;
    sh:property [
        sh:path icac-forensics:triageAccuracy ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:message "Triage accuracy must be between 0.0 and 1.0."@en
    ] ;
    sh:property [
        sh:path icac-forensics:priorityClassification ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "critical" "high" "medium" "low" "unknown" ) ;
        sh:message "Priority classification must be from the allowed list."@en
    ] .

icac-forensics:ScalableHashAnalysisShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ScalableHashAnalysis ;
    rdfs:label "Scalable Hash Analysis Shape"@en ;
    rdfs:comment "Validation shape for scalable hash analysis instances."@en ;
    sh:property [
        sh:path icac-forensics:hashDatabaseSize ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.001 ;
        sh:maxInclusive 10000.0 ;
        sh:message "Hash database size must be between 0.001 and 10000 million entries."@en
    ] ;
    sh:property [
        sh:path icac-forensics:hashMatchesFound ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 10000000 ;
        sh:message "Hash matches found must be between 0 and 10 million."@en
    ] .

# =============================================================================
# VICTIM IDENTIFICATION PROCESS SHAPES
# =============================================================================

icac-forensics:VictimIdentificationProcessShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:VictimIdentificationProcess ;
    rdfs:label "Victim Identification Process Shape"@en ;
    rdfs:comment "Validation shape for victim identification process instances."@en ;
    sh:property [
        sh:path icac-forensics:victimsIdentifiedCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 10000 ;
        sh:message "Victims identified count must be between 0 and 10000."@en
    ] ;
    sh:property [
        sh:path icac-forensics:victimGeographicOrigin ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 2 ;
        sh:maxLength 100 ;
        sh:message "Victim geographic origin should be 2-100 characters when provided."@en
    ] ;
    sh:property [
        sh:path icac-forensics:victimAgeRange ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "toddlers" "children" "teenagers" "toddlers_to_children" "children_to_teenagers" "toddlers_to_teenagers" "unknown" ) ;
        sh:message "Victim age range must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Victim identification process must specify start time."@en
    ] .

icac-forensics:ImageAnalysisForVictimIDShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ImageAnalysisForVictimID ;
    rdfs:label "Image Analysis for Victim ID Shape"@en ;
    rdfs:comment "Validation shape for image analysis for victim identification instances."@en ;
    sh:property [
        sh:path uco-action:usesTool ;
        sh:class uco-tool:Tool ;
        sh:minCount 1 ;
        sh:message "Image analysis for victim ID must specify at least one analysis tool."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Image analysis must specify analysis time."@en
    ] .

# =============================================================================
# SPECIALIZED DETECTION SHAPES
# =============================================================================

icac-forensics:K9AssistedForensicsShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:K9AssistedForensics ;
    rdfs:label "K9 Assisted Forensics Shape"@en ;
    rdfs:comment "Validation shape for K9 assisted forensics instances."@en ;
    sh:property [
        sh:path icac-forensics:k9AssistanceProvided ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "K9 assisted forensics must specify if K9 assistance was provided."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "K9 assisted forensics must specify start time."@en
    ] .

icac-forensics:ElectronicStorageDeviceDetectionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ElectronicStorageDeviceDetection ;
    rdfs:label "Electronic Storage Device Detection Shape"@en ;
    rdfs:comment "Validation shape for electronic storage device detection instances."@en ;
    sh:property [
        sh:path icac-forensics:detectionMethod ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "k9_detection" "manual_search" "electronic_scanning" "x_ray_scanning" "metal_detection" "thermal_imaging" ) ;
        sh:message "Detection method must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-forensics:detectionAccuracy ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:message "Detection accuracy must be between 0.0 and 1.0."@en
    ] .

icac-forensics:HiddenDeviceRecoveryShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:HiddenDeviceRecovery ;
    rdfs:label "Hidden Device Recovery Shape"@en ;
    rdfs:comment "Validation shape for hidden device recovery instances."@en ;
    sh:property [
        sh:path icac-forensics:devicesRecovered ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 1000 ;
        sh:message "Devices recovered must be between 1 and 1000."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Hidden device recovery must specify start time."@en
    ] .

# =============================================================================
# CORRELATION ANALYSIS SHAPES
# =============================================================================

icac-forensics:CrossPlatformCorrelationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:CrossPlatformCorrelation ;
    rdfs:label "Cross Platform Correlation Shape"@en ;
    rdfs:comment "Validation shape for cross platform correlation instances."@en ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Cross platform correlation must specify start time."@en
    ] ;
    sh:property [
        sh:path uco-action:usesTool ;
        sh:class uco-tool:Tool ;
        sh:minCount 1 ;
        sh:message "Cross platform correlation must specify at least one analysis tool."@en
    ] .

icac-forensics:TemporalPatternAnalysisShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:TemporalPatternAnalysis ;
    rdfs:label "Temporal Pattern Analysis Shape"@en ;
    rdfs:comment "Validation shape for temporal pattern analysis instances."@en ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Temporal pattern analysis must specify start time."@en
    ] ;
    sh:property [
        sh:path uco-core:endTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Temporal pattern analysis may specify end time."@en
    ] .

icac-forensics:BehavioralFingerprintingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:BehavioralFingerprinting ;
    rdfs:label "Behavioral Fingerprinting Shape"@en ;
    rdfs:comment "Validation shape for behavioral fingerprinting instances."@en ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Behavioral fingerprinting must specify start time."@en
    ] .

# =============================================================================
# OBJECT PROPERTY SHAPES
# =============================================================================

icac-forensics:UsesForensicToolShape rdf:type sh:PropertyShape ;
    sh:path uco-action:usesTool ;
    sh:name "uses forensic tool" ;
    sh:description "Links forensic actions to tools used" ;
    sh:class uco-tool:Tool ;
    sh:minCount 1 .

icac-forensics:ProducesForensicImageShape rdf:type sh:PropertyShape ;
    sh:path icac-forensics:forensicCopy ;
    sh:name "produces forensic image" ;
    sh:description "Links acquisition to forensic image produced" ;
    sh:class icac-forensics:ForensicImage ;
    sh:minCount 1 .

icac-forensics:HasVerificationHashShape rdf:type sh:PropertyShape ;
    sh:path icac-forensics:verificationHash ;
    sh:name "has verification hash" ;
    sh:description "Links forensic artifacts to verification hashes" ;
    sh:class uco-core:UcoObject ;
    sh:minCount 1 .

# =============================================================================
# CROSS-REFERENCE VALIDATION SHAPES
# =============================================================================

icac-forensics:ForensicAcquisitionCrossReferenceShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ForensicAcquisitionAction ;
    rdfs:label "Forensic Acquisition Cross Reference Shape"@en ;
    rdfs:comment "Validates cross-references between forensic acquisition and related entities."@en ;
    sh:sparql [
        sh:message "Forensic acquisition must have tool, evidence seized, and forensic copy."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this a icac-forensics:ForensicAcquisitionAction .
                FILTER NOT EXISTS {
                    $this uco-action:usesTool ?tool ;
                          icac-forensics:evidenceSeized ?evidence ;
                          icac-forensics:forensicCopy ?copy .
                }
            }
        """
    ] .

icac-forensics:WriteBlockingValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ForensicAcquisitionAction ;
    rdfs:label "Write Blocking Validation Shape"@en ;
    rdfs:comment "Validates write blocking usage in forensic acquisitions."@en ;
    sh:sparql [
        sh:message "Physical acquisitions should use write blocking."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-forensics:acquisitionMethod "physical" ;
                      icac-forensics:writeBlockingUsed false .
            }
        """
    ] .

icac-forensics:MassProcessingValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:MassDigitalEvidenceProcessing ;
    rdfs:label "Mass Processing Validation Shape"@en ;
    rdfs:comment "Validates mass digital evidence processing consistency."@en ;
    sh:sparql [
        sh:message "Large evidence volumes should have reasonable processing timeframes."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-forensics:evidenceVolumeTerabytes ?volume ;
                      icac-forensics:processingTimeframeDays ?days .
                FILTER (?volume > 100.0 && ?days < 30)
            }
        """
    ] .

# =============================================================================
# TEMPORAL VALIDATION SHAPES
# =============================================================================

icac-forensics:TemporalValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ForensicAcquisitionAction ;
    rdfs:label "Temporal Validation Shape"@en ;
    rdfs:comment "Validates temporal consistency in forensic actions."@en ;
    sh:sparql [
        sh:message "Acquisition start time must be before end time when both are specified."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this uco-core:startTime ?start ;
                      uco-core:endTime ?end .
                FILTER (?start >= ?end)
            }
        """
    ] .

icac-forensics:VerificationTimingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:EvidenceVerificationAction ;
    rdfs:label "Verification Timing Shape"@en ;
    rdfs:comment "Validates evidence verification timing."@en ;
    sh:sparql [
        sh:message "Evidence verification should occur after acquisition."@en ;
        sh:select """
            SELECT $this
            WHERE {
                ?acquisition icac-forensics:forensicCopy ?image .
                ?image icac-forensics:verificationHash ?hash .
                $this uco-core:object ?hash ;
                      uco-core:startTime ?verificationTime .
                ?acquisition uco-core:startTime ?acquisitionTime .
                FILTER (?verificationTime < ?acquisitionTime)
            }
        """
    ] .

# =============================================================================
# DATA QUALITY SHAPES
# =============================================================================

icac-forensics:DataQualityShape rdf:type sh:NodeShape ;
    sh:targetClass icac-forensics:ForensicAcquisitionAction ,
                   icac-forensics:ForensicImage ,
                   icac-forensics:MassDigitalEvidenceProcessing ;
    rdfs:label "Data Quality Shape"@en ;
    rdfs:comment "Validates data quality for forensic entities."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 5 ;
        sh:maxLength 200 ;
        sh:message "Label should be between 5 and 200 characters when provided."@en
    ] ;
    sh:property [
        sh:path rdfs:comment ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 10 ;
        sh:maxLength 1000 ;
        sh:message "Comment should be between 10 and 1000 characters when provided."@en
    ] . 