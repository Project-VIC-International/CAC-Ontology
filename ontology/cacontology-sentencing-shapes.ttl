@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix uco-core: <https://ontology.unifiedcyberontology.org/uco/core/> .
@prefix uco-identity: <https://ontology.unifiedcyberontology.org/uco/identity/> .
@prefix uco-action: <https://ontology.unifiedcyberontology.org/uco/action/> .
@prefix uco-role: <https://ontology.unifiedcyberontology.org/uco/role/> .
@prefix case-investigation: <https://ontology.caseontology.org/case/investigation/> .
@prefix cacontology: <https://cacontology.projectvic.org#> .
@prefix cacontology-sentencing: <https://cacontology.projectvic.org/sentencing#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix dcterms: <http://purl.org/dc/terms/> .

# Ontology Declaration
<https://cacontology.projectvic.org/sentencing/shapes/2.3.0> rdf:type owl:Ontology ;
    rdfs:label "CAC Sentencing SHACL Shapes"@en ;
    rdfs:comment "SHACL validation shapes for the ICAC Sentencing Ontology, providing validation for legal outcomes, federal sentences, judicial proceedings, and punishment guidelines."@en ;
    owl:versionIRI <https://cacontology.projectvic.org/sentencing/shapes/2.3.0> ;
    owl:versionInfo "2.3.0" ;
    dcterms:creator "CAC Ontology Team" ;
    dcterms:modified "2026-01-01"^^xsd:date ;
    owl:imports <https://cacontology.projectvic.org/sentencing/2.3.0> ,
                <http://purl.org/nemo/gufo> ,
                <https://ontology.unifiedcyberontology.org/uco/core/> .

# =============================================================================
# SENTENCING OUTCOME SHAPES
# =============================================================================

cacontology-sentencing:SentencingOutcomeShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:SentencingOutcome ;
    rdfs:label "Sentencing Outcome Shape"@en ;
    rdfs:comment "Validation shape for sentencing outcome instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:sentenceType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "imprisonment" "probation" "suspended_sentence" "community_service" "fine" "restitution" "treatment_order" "mixed_sentence" ) ;
        sh:message "Sentencing outcome must specify sentence type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:sentenceDuration ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 50.0 ;
        sh:message "Sentence duration must be between 0 and 50 years."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:sentenceDate ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Sentencing outcome must specify sentence date."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:jurisdiction ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "federal" "state" "local" "military" "tribal" "international" ) ;
        sh:message "Sentencing outcome must specify jurisdiction from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:appealStatus ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "no_appeal" "appeal_pending" "appeal_denied" "appeal_granted" "sentence_modified" "conviction_overturned" ) ;
        sh:message "Appeal status must be from the allowed list."@en
    ] .

cacontology-sentencing:ImprisonmentSentenceShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ImprisonmentSentence ;
    rdfs:label "Imprisonment Sentence Shape"@en ;
    rdfs:comment "Validation shape for imprisonment sentence instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:facilityType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "federal_prison" "state_prison" "county_jail" "minimum_security" "medium_security" "maximum_security" "supermax" ) ;
        sh:message "Imprisonment sentence must specify facility type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:paroleEligibility ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Imprisonment sentence must specify parole eligibility."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:minimumServed ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 50.0 ;
        sh:message "Minimum time served must be between 0 and 50 years."@en
    ] .

cacontology-sentencing:ProbationSentenceShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ProbationSentence ;
    rdfs:label "Probation Sentence Shape"@en ;
    rdfs:comment "Validation shape for probation sentence instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:probationConditions ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 50 ;
        sh:message "Probation sentence must have between 1 and 50 conditions."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:supervisionLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "unsupervised" "administrative" "standard" "intensive" "electronic_monitoring" "residential" ) ;
        sh:message "Probation sentence must specify supervision level from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:reportingFrequency ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "monthly" "bi_weekly" "weekly" "daily" "as_directed" "none" ) ;
        sh:message "Probation sentence must specify reporting frequency from the allowed list."@en
    ] .

# =============================================================================
# LEGAL PROCEEDING AND SENTENCE STRUCTURE SHAPES
# =============================================================================

cacontology-sentencing:LegalProceedingShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:LegalProceeding ;
    rdfs:label "Legal Proceeding Shape"@en ;
    rdfs:comment "Validation shape for legal proceeding instances, including pretrial bail status (e.g., held without bail in the Utah Christensen case)."@en ;
    sh:property [
        sh:path cacontology-sentencing:bailStatus ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "released_on_bail" "held_without_bail" "released_on_own_recognizance" "bail_denied" "bail_revoked" ) ;
        sh:message "Bail status, when provided, must be one of: released_on_bail, held_without_bail, released_on_own_recognizance, bail_denied, bail_revoked."@en
    ] .

cacontology-sentencing:CriminalSentenceShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:CriminalSentence ;
    rdfs:label "Criminal Sentence Shape"@en ;
    rdfs:comment "Validation shape for criminal sentences, including concurrency semantics for concurrent jail/probation terms (as in the Utah Christensen 2021 sentences)."@en ;
    sh:property [
        sh:path cacontology-sentencing:sentenceConcurrency ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "concurrent" "consecutive" "mixed" ) ;
        sh:message "Sentence concurrency, when provided, must be one of: concurrent, consecutive, mixed."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:concurrentWith ;
        sh:class cacontology-sentencing:CriminalSentence ;
        sh:minCount 0 ;
        sh:message "Sentences linked via concurrentWith must point to other CriminalSentence instances."@en
    ] .

cacontology-sentencing:CriminalSentenceConcurrencyBusinessRule rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:CriminalSentence ;
    rdfs:label "Criminal Sentence Concurrency Business Rule"@en ;
    rdfs:comment "Business rule: a sentence MUST NOT be declared concurrent with itself."@en ;
    sh:sparql [
        sh:message "A criminal sentence cannot be concurrentWith itself."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this cacontology-sentencing:concurrentWith $this .
            }
        """
    ] .

# =============================================================================
# LEGAL CHARGE SHAPES
# =============================================================================

cacontology-sentencing:LegalChargeShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:LegalCharge ;
    rdfs:label "Legal Charge Shape"@en ;
    rdfs:comment "Validation shape for legal charge instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:chargeType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "felony" "misdemeanor" "infraction" "violation" "contempt" "federal_crime" ) ;
        sh:message "Legal charge must specify charge type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:chargeClass ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "class_a" "class_b" "class_c" "class_d" "class_e" "unclassified" "capital" ) ;
        sh:message "Legal charge must specify charge class from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:statuteReference ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 5 ;
        sh:maxLength 100 ;
        sh:message "Legal charge must specify statute reference (5-100 characters)."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:maximumPenalty ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 99.0 ;
        sh:message "Maximum penalty must be between 0 and 99 years."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:pleaEntered ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "guilty" "not_guilty" "no_contest" "alford_plea" "not_entered" ) ;
        sh:message "Plea entered must be from the allowed list."@en
    ] .

cacontology-sentencing:FelonyChargeShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:FelonyCharge ;
    rdfs:label "Felony Charge Shape"@en ;
    rdfs:comment "Validation shape for felony charge instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:felonyLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "first_degree" "second_degree" "third_degree" "fourth_degree" "unclassified" "capital" ) ;
        sh:message "Felony charge must specify felony level from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:violentCrime ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Felony charge must specify if it is a violent crime."@en
    ] .

# =============================================================================
# FLORIDA STATE CHARGE SHAPES
# Based on Miami ICAC undercover operation press release
# =============================================================================

cacontology-sentencing:FloridaStateChargeShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:FloridaStateCharge ;
    rdfs:label "Florida State Charge Shape"@en ;
    rdfs:comment "Validation shape for Florida state charge instances in ICAC cases."@en ;
    sh:property [
        sh:path cacontology-sentencing:floridaStatute ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:pattern "^F\\.S\\. [0-9]+\\.[0-9]+.*$" ;
        sh:message "Florida state charge must specify Florida Statute reference (e.g., 'F.S. 847.0135')."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:chargeClassification ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "capital_felony" "life_felony" "first_degree_felony" "second_degree_felony" "third_degree_felony" "first_degree_misdemeanor" "second_degree_misdemeanor" ) ;
        sh:message "Florida charge must specify classification from the allowed list."@en
    ] .

cacontology-sentencing:TravelingToMeetAfterComputerLureShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:TravelingToMeetAfterComputerLure ;
    rdfs:label "Traveling To Meet After Computer Lure Shape"@en ;
    rdfs:comment "Validation shape for F.S. 847.0135(4) traveling to meet a minor after computer lure charges."@en ;
    sh:property [
        sh:path cacontology-sentencing:travelOccurred ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Must specify whether actual travel occurred."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:electronicCommunicationUsed ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue true ;
        sh:message "Electronic communication must have been used for this charge."@en
    ] .

cacontology-sentencing:ComputerSeduceSolicitLureShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ComputerSeduceSolicitLure ;
    rdfs:label "Computer Seduce Solicit Lure Shape"@en ;
    rdfs:comment "Validation shape for F.S. 847.0135(3) computer solicitation charges."@en ;
    sh:property [
        sh:path cacontology-sentencing:solicitationType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "seduce" "solicit" "lure" "entice" "multiple" ) ;
        sh:message "Must specify type of solicitation from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:communicationPlatform ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "May specify the communication platform used."@en
    ] .

cacontology-sentencing:DirectPromotionOfSexualPerformanceShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:DirectPromotionOfSexualPerformance ;
    rdfs:label "Direct Promotion of Sexual Performance Shape"@en ;
    rdfs:comment "Validation shape for F.S. 827.071(4) promoting sexual performance by a child charges."@en ;
    sh:property [
        sh:path cacontology-sentencing:promotionType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "direct_promotion" "directing" "producing" "facilitating" ) ;
        sh:message "Must specify type of promotion from the allowed list."@en
    ] .

cacontology-sentencing:ContributingToDelinquencyShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ContributingToDelinquency ;
    rdfs:label "Contributing to Delinquency Shape"@en ;
    rdfs:comment "Validation shape for F.S. 827.04 contributing to delinquency charges."@en ;
    sh:property [
        sh:path cacontology-sentencing:contributionType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "delinquency" "dependency" "both" ) ;
        sh:message "Must specify whether contribution was to delinquency, dependency, or both."@en
    ] .

# =============================================================================
# CONVICTION RECORD SHAPES
# =============================================================================

cacontology-sentencing:ConvictionRecordShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ConvictionRecord ;
    rdfs:label "Conviction Record Shape"@en ;
    rdfs:comment "Validation shape for conviction record instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:convictionDate ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Conviction record must specify conviction date."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:convictionType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "jury_verdict" "bench_trial" "plea_agreement" "default_judgment" "summary_conviction" ) ;
        sh:message "Conviction record must specify conviction type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:chargeCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 100 ;
        sh:message "Conviction record must have between 1 and 100 charges."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:priorConvictions ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 50 ;
        sh:message "Prior convictions must be between 0 and 50."@en
    ] .

# =============================================================================
# SENTENCING GUIDELINES SHAPES
# =============================================================================

cacontology-sentencing:SentencingGuidelinesShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:SentencingGuidelines ;
    rdfs:label "Sentencing Guidelines Shape"@en ;
    rdfs:comment "Validation shape for sentencing guidelines instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:guidelineSystem ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "federal_guidelines" "state_guidelines" "advisory_guidelines" "mandatory_minimums" "judicial_discretion" ) ;
        sh:message "Sentencing guidelines must specify guideline system from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:baseOffenseLevel ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 43 ;
        sh:message "Base offense level must be between 1 and 43."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:criminalHistoryCategory ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "I" "II" "III" "IV" "V" "VI" ) ;
        sh:message "Criminal history category must be from I to VI."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:adjustmentPoints ;
        sh:datatype xsd:integer ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive -10 ;
        sh:maxInclusive 20 ;
        sh:message "Adjustment points must be between -10 and 20."@en
    ] .

cacontology-sentencing:EnhancementFactorShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:EnhancementFactor ;
    rdfs:label "Enhancement Factor Shape"@en ;
    rdfs:comment "Validation shape for enhancement factor instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:enhancementType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "victim_vulnerability" "leadership_role" "use_of_technology" "commercial_purpose" "distribution_scale" "repeat_offender" "violence_threat" ) ;
        sh:message "Enhancement factor must specify enhancement type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:enhancementValue ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 10 ;
        sh:message "Enhancement factor must have enhancement value between 1 and 10."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:enhancementJustification ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 10 ;
        sh:maxLength 500 ;
        sh:message "Enhancement justification must be between 10 and 500 characters."@en
    ] .

# =============================================================================
# RESTITUTION AND FINES SHAPES
# =============================================================================

cacontology-sentencing:RestitutionOrderShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:RestitutionOrder ;
    rdfs:label "Restitution Order Shape"@en ;
    rdfs:comment "Validation shape for restitution order instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:restitutionAmount ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1.0 ;
        sh:maxInclusive 10000000.0 ;
        sh:message "Restitution amount must be between $1 and $10,000,000."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:paymentSchedule ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "lump_sum" "monthly_payments" "quarterly_payments" "annual_payments" "income_based" "deferred" ) ;
        sh:message "Restitution order must specify payment schedule from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:victimCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 1000 ;
        sh:message "Restitution order must specify victim count between 1 and 1000."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:paymentStatus ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "pending" "current" "delinquent" "completed" "defaulted" "modified" ) ;
        sh:message "Payment status must be from the allowed list."@en
    ] .

cacontology-sentencing:CriminalFineShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:CriminalFine ;
    rdfs:label "Criminal Fine Shape"@en ;
    rdfs:comment "Validation shape for criminal fine instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:fineAmount ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1.0 ;
        sh:maxInclusive 1000000.0 ;
        sh:message "Fine amount must be between $1 and $1,000,000."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:fineType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "statutory_fine" "discretionary_fine" "alternative_fine" "cost_of_prosecution" "forfeiture" ) ;
        sh:message "Criminal fine must specify fine type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:paymentDeadline ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Criminal fine may specify payment deadline."@en
    ] .

# =============================================================================
# TREATMENT ORDER SHAPES
# =============================================================================

cacontology-sentencing:TreatmentOrderShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:TreatmentOrder ;
    rdfs:label "Treatment Order Shape"@en ;
    rdfs:comment "Validation shape for treatment order instances."@en ;
    sh:property [
        sh:path cacontology-sentencing:treatmentType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "psychological_counseling" "sex_offender_treatment" "substance_abuse_treatment" "anger_management" "mental_health_treatment" "cognitive_behavioral_therapy" ) ;
        sh:message "Treatment order must specify treatment type from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:treatmentDuration ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1.0 ;
        sh:maxInclusive 260.0 ;
        sh:message "Treatment duration must be between 1 and 260 weeks (5 years)."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:treatmentProvider ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "court_approved" "state_certified" "private_practice" "institutional" "community_based" ) ;
        sh:message "Treatment order must specify treatment provider from the allowed list."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:complianceRequired ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Treatment order must specify if compliance is required."@en
    ] .

# =============================================================================
# OBJECT PROPERTY SHAPES
# =============================================================================

cacontology-sentencing:ResultsFromChargeShape rdf:type sh:PropertyShape ;
    sh:path cacontology-sentencing:resultsFromCharge ;
    sh:name "results from charge" ;
    sh:description "Links sentencing outcome to legal charge" ;
    sh:class cacontology-sentencing:LegalCharge ;
    sh:minCount 1 .

cacontology-sentencing:FollowsGuidelinesShape rdf:type sh:PropertyShape ;
    sh:path cacontology-sentencing:followsGuidelines ;
    sh:name "follows guidelines" ;
    sh:description "Links sentencing to guidelines used" ;
    sh:class cacontology-sentencing:SentencingGuidelines ;
    sh:minCount 0 .

cacontology-sentencing:IncludesRestitutionShape rdf:type sh:PropertyShape ;
    sh:path cacontology-sentencing:includesRestitution ;
    sh:name "includes restitution" ;
    sh:description "Links sentencing to restitution order" ;
    sh:class cacontology-sentencing:RestitutionOrder ;
    sh:minCount 0 .

cacontology-sentencing:IncludesFineShape rdf:type sh:PropertyShape ;
    sh:path cacontology-sentencing:includesFine ;
    sh:name "includes fine" ;
    sh:description "Links sentencing to criminal fine" ;
    sh:class cacontology-sentencing:CriminalFine ;
    sh:minCount 0 .

cacontology-sentencing:RequiresTreatmentShape rdf:type sh:PropertyShape ;
    sh:path cacontology-sentencing:requiresTreatment ;
    sh:name "requires treatment" ;
    sh:description "Links sentencing to treatment order" ;
    sh:class cacontology-sentencing:TreatmentOrder ;
    sh:minCount 0 .

cacontology-sentencing:AppliesEnhancementShape rdf:type sh:PropertyShape ;
    sh:path cacontology-sentencing:appliesEnhancement ;
    sh:name "applies enhancement" ;
    sh:description "Links guidelines to enhancement factors" ;
    sh:class cacontology-sentencing:EnhancementFactor ;
    sh:minCount 0 .

# =============================================================================
# CROSS-REFERENCE VALIDATION SHAPES
# =============================================================================

cacontology-sentencing:SentencingCrossReferenceShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:SentencingOutcome ;
    rdfs:label "Sentencing Cross Reference Shape"@en ;
    rdfs:comment "Validates cross-references between sentencing and related entities."@en ;
    sh:sparql [
        sh:message "Sentencing outcome must result from at least one legal charge."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this a cacontology-sentencing:SentencingOutcome .
                FILTER NOT EXISTS {
                    $this cacontology-sentencing:resultsFromCharge ?charge .
                }
            }
        """
    ] .

cacontology-sentencing:SentenceDurationValidationShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:SentencingOutcome ;
    rdfs:label "Sentence Duration Validation Shape"@en ;
    rdfs:comment "Validates sentence duration consistency."@en ;
    sh:sparql [
        sh:message "Imprisonment sentences should have duration specified."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this cacontology-sentencing:sentenceType "imprisonment" .
                FILTER NOT EXISTS {
                    $this cacontology-sentencing:sentenceDuration ?duration .
                }
            }
        """
    ] .

cacontology-sentencing:RestitutionValidationShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:RestitutionOrder ;
    rdfs:label "Restitution Validation Shape"@en ;
    rdfs:comment "Validates restitution order consistency."@en ;
    sh:sparql [
        sh:message "Restitution amount should be reasonable for victim count."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this cacontology-sentencing:restitutionAmount ?amount ;
                      cacontology-sentencing:victimCount ?victims .
                FILTER (?amount > (?victims * 100000))
            }
        """
    ] .

# =============================================================================
# TEMPORAL VALIDATION SHAPES
# =============================================================================

cacontology-sentencing:TemporalValidationShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ConvictionRecord ;
    rdfs:label "Temporal Validation Shape"@en ;
    rdfs:comment "Validates temporal consistency in conviction records."@en ;
    sh:sparql [
        sh:message "Conviction date must be before or equal to sentence date."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this cacontology-sentencing:convictionDate ?convictionDate .
                ?sentence cacontology-sentencing:resultsFromCharge ?charge ;
                         cacontology-sentencing:sentenceDate ?sentenceDate .
                ?charge cacontology-sentencing:convictionRecord $this .
                FILTER (?convictionDate > ?sentenceDate)
            }
        """
    ] .

cacontology-sentencing:PaymentDeadlineValidationShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:CriminalFine ;
    rdfs:label "Payment Deadline Validation Shape"@en ;
    rdfs:comment "Validates payment deadline consistency."@en ;
    sh:sparql [
        sh:message "Payment deadline should be in the future when specified."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this cacontology-sentencing:paymentDeadline ?deadline .
                FILTER (?deadline <= NOW())
            }
        """
    ] .

# =============================================================================
# DATA QUALITY SHAPES
# =============================================================================

cacontology-sentencing:DataQualityShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:SentencingOutcome ;
    rdfs:label "Data Quality Shape"@en ;
    rdfs:comment "Validates data quality for sentencing outcomes."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 5 ;
        sh:maxLength 200 ;
        sh:message "Label should be between 5 and 200 characters when provided."@en
    ] ;
    sh:property [
        sh:path rdfs:comment ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 10 ;
        sh:maxLength 1000 ;
        sh:message "Comment should be between 10 and 1000 characters when provided."@en
    ] .

# =============================================================================
# FLORIDA STATE CHARGE SHAPES (Miami ICAC Case Enhancement)
# =============================================================================

cacontology-sentencing:FloridaStateChargeShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:FloridaStateCharge ;
    rdfs:label "Florida State Charge Shape"@en ;
    rdfs:comment "Validation shape for Florida state criminal charges."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype rdf:langString ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Florida charge should have a label."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:floridaStatute ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:pattern "^F\\.S\\. [0-9]+\\.[0-9]+.*$" ;
        sh:message "Florida statute should follow F.S. format (e.g., 'F.S. 847.0135')."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:chargeClassification ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "Capital Felony" "Life Felony" "First Degree Felony" "Second Degree Felony" "Third Degree Felony" "First Degree Misdemeanor" "Second Degree Misdemeanor" ) ;
        sh:message "Charge classification must be from the allowed Florida list."@en
    ] .

cacontology-sentencing:TravelingToMeetAfterComputerLureShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:TravelingToMeetAfterComputerLure ;
    rdfs:label "Traveling to Meet After Computer Lure Shape"@en ;
    rdfs:comment "Validation shape for Florida traveling to meet charges."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype rdf:langString ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Traveling charge should have a label."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:travelOccurred ;
        sh:datatype xsd:boolean ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "May specify if travel to the location occurred."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:electronicCommunicationUsed ;
        sh:datatype xsd:boolean ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "May specify if electronic communication was used."@en
    ] .

cacontology-sentencing:DirectPromotionOfSexualPerformanceShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:DirectPromotionOfSexualPerformance ;
    rdfs:label "Direct Promotion of Sexual Performance Shape"@en ;
    rdfs:comment "Validation shape for Florida direct promotion charges."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype rdf:langString ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Direct promotion charge should have a label."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:sexualPerformancePromotion ;
        sh:datatype xsd:boolean ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "May specify if sexual performance promotion occurred."@en
    ] .

cacontology-sentencing:ComputerSeduceSolicitLureShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ComputerSeduceSolicitLure ;
    rdfs:label "Computer Seduce Solicit Lure Shape"@en ;
    rdfs:comment "Validation shape for Florida computer lure charges."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype rdf:langString ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Computer lure charge should have a label."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:computerLureMethod ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "messaging app" "social media" "email" "chat room" "gaming platform" "video chat" "other" ) ;
        sh:message "Computer lure method should be from the allowed list."@en
    ] .

cacontology-sentencing:ContributingToDelinquencyShape rdf:type sh:NodeShape ;
    sh:targetClass cacontology-sentencing:ContributingToDelinquency ;
    rdfs:label "Contributing to Delinquency Shape"@en ;
    rdfs:comment "Validation shape for Florida contributing to delinquency charges."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype rdf:langString ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Contributing charge should have a label."@en
    ] ;
    sh:property [
        sh:path cacontology-sentencing:childDelinquencyContribution ;
        sh:datatype xsd:boolean ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "May specify if contribution to child delinquency occurred."@en
    ] . 