@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix uco-core: <https://ontology.unifiedcyberontology.org/core#> .
@prefix uco-identity: <https://ontology.unifiedcyberontology.org/identity#> .
@prefix uco-action: <https://ontology.unifiedcyberontology.org/action#> .
@prefix uco-role: <https://ontology.unifiedcyberontology.org/role#> .
@prefix uco-location: <https://ontology.unifiedcyberontology.org/location#> .
@prefix case-investigation: <https://ontology.caseontology.org/case/investigation#> .
@prefix icac: <https://ontology.unifiedcyberontology.org/icac#> .
@prefix icac-stranger: <https://ontology.unifiedcyberontology.org/icac/stranger-abduction#> .

# =============================================================================
# STRANGER ABDUCTION SHAPES
# =============================================================================

icac-stranger:StrangerAbductionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:StrangerAbduction ;
    rdfs:label "Stranger Abduction Shape"@en ;
    rdfs:comment "Validation shape for stranger abduction instances."@en ;
    sh:property [
        sh:path icac-stranger:abductionType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "opportunistic" "predatory" "planned" "random" "targeted" "crime_of_opportunity" ) ;
        sh:message "Stranger abduction must specify abduction type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:abductionLocation ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "public_space" "school_area" "residential_area" "commercial_area" "transportation_hub" "recreational_area" "remote_location" ) ;
        sh:message "Stranger abduction must specify abduction location type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:victimAge ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 17 ;
        sh:message "Victim age must be between 0 and 17 years."@en
    ] ;
    sh:property [
        sh:path icac-stranger:abductionTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Stranger abduction must specify abduction time."@en
    ] ;
    sh:property [
        sh:path icac-stranger:reportedTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Stranger abduction must specify reported time."@en
    ] ;
    sh:property [
        sh:path icac-stranger:responseTime ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.1 ;
        sh:maxInclusive 168.0 ;
        sh:message "Response time must be between 0.1 and 168 hours (1 week)."@en
    ] ;
    sh:property [
        sh:path icac-stranger:riskLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "critical" "high" "medium" "low" "unknown" ) ;
        sh:message "Stranger abduction must specify risk level from the allowed list."@en
    ] .

icac-stranger:OpportunisticAbductionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:OpportunisticAbduction ;
    rdfs:label "Opportunistic Abduction Shape"@en ;
    rdfs:comment "Validation shape for opportunistic abduction instances."@en ;
    sh:property [
        sh:path icac-stranger:opportunityFactor ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "isolated_victim" "lack_of_supervision" "vulnerable_situation" "environmental_factor" "timing_factor" "distraction" ) ;
        sh:message "Opportunistic abduction must specify opportunity factor from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:impulsiveNature ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Opportunistic abduction must specify if it was impulsive in nature."@en
    ] .

icac-stranger:PredatoryAbductionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:PredatoryAbduction ;
    rdfs:label "Predatory Abduction Shape"@en ;
    rdfs:comment "Validation shape for predatory abduction instances."@en ;
    sh:property [
        sh:path icac-stranger:huntingBehavior ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Predatory abduction must specify if hunting behavior was observed."@en
    ] ;
    sh:property [
        sh:path icac-stranger:surveillancePeriod ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.1 ;
        sh:maxInclusive 720.0 ;
        sh:message "Surveillance period must be between 0.1 and 720 hours (30 days)."@en
    ] ;
    sh:property [
        sh:path icac-stranger:victimSelection ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "specific_criteria" "random_selection" "convenience" "vulnerability_based" "proximity_based" ) ;
        sh:message "Predatory abduction must specify victim selection method from the allowed list."@en
    ] .

# =============================================================================
# ABDUCTOR PROFILE SHAPES
# =============================================================================

icac-stranger:AbductorProfileShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:AbductorProfile ;
    rdfs:label "Abductor Profile Shape"@en ;
    rdfs:comment "Validation shape for abductor profile instances."@en ;
    sh:property [
        sh:path icac-stranger:profileType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "behavioral_profile" "demographic_profile" "psychological_profile" "criminal_profile" "composite_profile" ) ;
        sh:message "Abductor profile must specify profile type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:ageRange ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "under_18" "18_25" "26_35" "36_45" "46_55" "56_65" "over_65" "unknown" ) ;
        sh:message "Age range must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:genderProfile ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "male" "female" "unknown" "other" ) ;
        sh:message "Gender profile must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:criminalHistory ;
        sh:datatype xsd:boolean ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Abductor profile may specify if criminal history exists."@en
    ] ;
    sh:property [
        sh:path icac-stranger:priorOffenses ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 50 ;
        sh:message "Prior offenses must be between 0 and 50."@en
    ] ;
    sh:property [
        sh:path icac-stranger:psychologicalFactors ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "antisocial_personality" "sexual_deviance" "substance_abuse" "mental_illness" "impulse_control" "multiple_factors" ) ;
        sh:message "Psychological factors must be from the allowed list."@en
    ] .

icac-stranger:BehavioralProfileShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:BehavioralProfile ;
    rdfs:label "Behavioral Profile Shape"@en ;
    rdfs:comment "Validation shape for behavioral profile instances."@en ;
    sh:property [
        sh:path icac-stranger:approachMethod ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "deception" "force" "enticement" "authority_figure" "assistance_ruse" "direct_approach" ) ;
        sh:message "Behavioral profile must specify approach method from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:communicationStyle ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "friendly" "authoritative" "threatening" "manipulative" "silent" "erratic" ) ;
        sh:message "Communication style must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:organizationLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "highly_organized" "organized" "mixed" "disorganized" "chaotic" ) ;
        sh:message "Behavioral profile must specify organization level from the allowed list."@en
    ] .

# =============================================================================
# ABDUCTION METHOD SHAPES
# =============================================================================

icac-stranger:AbductionMethodShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:AbductionMethod ;
    rdfs:label "Abduction Method Shape"@en ;
    rdfs:comment "Validation shape for abduction method instances."@en ;
    sh:property [
        sh:path icac-stranger:methodType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "physical_force" "deception" "enticement" "threat" "weapon_use" "vehicle_abduction" "walk_away" ) ;
        sh:message "Abduction method must specify method type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:forceLevel ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "none" "minimal" "moderate" "significant" "extreme" "lethal" ) ;
        sh:message "Force level must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:weaponInvolved ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Abduction method must specify if weapon was involved."@en
    ] ;
    sh:property [
        sh:path icac-stranger:vehicleUsed ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Abduction method must specify if vehicle was used."@en
    ] ;
    sh:property [
        sh:path icac-stranger:accomplices ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 10 ;
        sh:message "Number of accomplices must be between 0 and 10."@en
    ] .

icac-stranger:VehicleAbductionShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:VehicleAbduction ;
    rdfs:label "Vehicle Abduction Shape"@en ;
    rdfs:comment "Validation shape for vehicle abduction instances."@en ;
    sh:property [
        sh:path icac-stranger:vehicleType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "sedan" "suv" "truck" "van" "motorcycle" "commercial_vehicle" "unknown" ) ;
        sh:message "Vehicle abduction must specify vehicle type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:vehicleColor ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:in ( "white" "black" "gray" "silver" "red" "blue" "green" "yellow" "brown" "other" "unknown" ) ;
        sh:message "Vehicle color must be from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:licensePlateInfo ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Vehicle abduction must specify if license plate information is available."@en
    ] .

# =============================================================================
# SEARCH OPERATION SHAPES
# =============================================================================

icac-stranger:SearchOperationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:SearchOperation ;
    rdfs:label "Search Operation Shape"@en ;
    rdfs:comment "Validation shape for search operation instances."@en ;
    sh:property [
        sh:path icac-stranger:searchType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "ground_search" "air_search" "water_search" "urban_search" "wilderness_search" "multi_domain_search" ) ;
        sh:message "Search operation must specify search type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:searchRadius ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.1 ;
        sh:maxInclusive 1000.0 ;
        sh:message "Search radius must be between 0.1 and 1000 kilometers."@en
    ] ;
    sh:property [
        sh:path icac-stranger:searchDuration ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 1.0 ;
        sh:maxInclusive 8760.0 ;
        sh:message "Search duration must be between 1 and 8760 hours (1 year)."@en
    ] ;
    sh:property [
        sh:path icac-stranger:personnelCount ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 1000 ;
        sh:message "Search operation must have between 1 and 1000 personnel."@en
    ] ;
    sh:property [
        sh:path icac-stranger:resourcesDeployed ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 100 ;
        sh:message "Search operation must deploy between 1 and 100 resources."@en
    ] ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Search operation must specify start time."@en
    ] ;
    sh:property [
        sh:path uco-core:endTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Search operation may specify end time."@en
    ] .

icac-stranger:GroundSearchShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:GroundSearch ;
    rdfs:label "Ground Search Shape"@en ;
    rdfs:comment "Validation shape for ground search instances."@en ;
    sh:property [
        sh:path icac-stranger:searchPattern ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "grid_search" "line_search" "spiral_search" "zone_search" "hasty_search" "containment_search" ) ;
        sh:message "Ground search must specify search pattern from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:terrainType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "urban" "suburban" "rural" "wilderness" "forest" "desert" "mountainous" "coastal" ) ;
        sh:message "Ground search must specify terrain type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:canineUnits ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 50 ;
        sh:message "Number of canine units must be between 0 and 50."@en
    ] .

# =============================================================================
# AMBER ALERT SHAPES
# =============================================================================

icac-stranger:AmberAlertShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:AmberAlert ;
    rdfs:label "Amber Alert Shape"@en ;
    rdfs:comment "Validation shape for Amber Alert instances."@en ;
    sh:property [
        sh:path icac-stranger:alertLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "local" "regional" "statewide" "multi_state" "national" "international" ) ;
        sh:message "Amber Alert must specify alert level from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:activationTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Amber Alert must specify activation time."@en
    ] ;
    sh:property [
        sh:path icac-stranger:deactivationTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:message "Amber Alert may specify deactivation time."@en
    ] ;
    sh:property [
        sh:path icac-stranger:alertDuration ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.1 ;
        sh:maxInclusive 720.0 ;
        sh:message "Alert duration must be between 0.1 and 720 hours (30 days)."@en
    ] ;
    sh:property [
        sh:path icac-stranger:distributionChannels ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 50 ;
        sh:message "Amber Alert must use between 1 and 50 distribution channels."@en
    ] ;
    sh:property [
        sh:path icac-stranger:publicResponse ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 10000 ;
        sh:message "Public response count must be between 0 and 10000."@en
    ] .

icac-stranger:AlertCriteriaShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:AlertCriteria ;
    rdfs:label "Alert Criteria Shape"@en ;
    rdfs:comment "Validation shape for alert criteria instances."@en ;
    sh:property [
        sh:path icac-stranger:criteriaType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "age_criteria" "abduction_confirmed" "danger_criteria" "description_available" "time_criteria" "jurisdiction_criteria" ) ;
        sh:message "Alert criteria must specify criteria type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:criteriaMet ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Alert criteria must specify if criteria is met."@en
    ] ;
    sh:property [
        sh:path icac-stranger:verificationLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "confirmed" "probable" "possible" "unverified" "disputed" ) ;
        sh:message "Alert criteria must specify verification level from the allowed list."@en
    ] .

# =============================================================================
# VICTIM RECOVERY SHAPES
# =============================================================================

icac-stranger:VictimRecoveryShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:VictimRecovery ;
    rdfs:label "Victim Recovery Shape"@en ;
    rdfs:comment "Validation shape for victim recovery instances."@en ;
    sh:property [
        sh:path icac-stranger:recoveryType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "safe_recovery" "rescue_operation" "self_escape" "release_by_abductor" "discovery_by_public" "law_enforcement_recovery" ) ;
        sh:message "Victim recovery must specify recovery type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:recoveryTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Victim recovery must specify recovery time."@en
    ] ;
    sh:property [
        sh:path icac-stranger:recoveryLocation ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "original_location" "nearby_location" "distant_location" "different_jurisdiction" "different_state" "different_country" ) ;
        sh:message "Victim recovery must specify recovery location type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:victimCondition ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "unharmed" "minor_injuries" "significant_injuries" "critical_condition" "deceased" "unknown" ) ;
        sh:message "Victim recovery must specify victim condition from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:medicalAttention ;
        sh:datatype xsd:boolean ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Victim recovery must specify if medical attention was required."@en
    ] ;
    sh:property [
        sh:path icac-stranger:captivityDuration ;
        sh:datatype xsd:decimal ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.1 ;
        sh:maxInclusive 8760.0 ;
        sh:message "Captivity duration must be between 0.1 and 8760 hours (1 year)."@en
    ] .

icac-stranger:RescueOperationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:RescueOperation ;
    rdfs:label "Rescue Operation Shape"@en ;
    rdfs:comment "Validation shape for rescue operation instances."@en ;
    sh:property [
        sh:path icac-stranger:operationType ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "tactical_rescue" "negotiated_release" "stealth_operation" "coordinated_assault" "emergency_response" "planned_operation" ) ;
        sh:message "Rescue operation must specify operation type from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:riskAssessment ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ( "low_risk" "moderate_risk" "high_risk" "extreme_risk" "unknown_risk" ) ;
        sh:message "Rescue operation must specify risk assessment from the allowed list."@en
    ] ;
    sh:property [
        sh:path icac-stranger:specializedUnits ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minInclusive 0 ;
        sh:maxInclusive 20 ;
        sh:message "Number of specialized units must be between 0 and 20."@en
    ] .

# =============================================================================
# OBJECT PROPERTY SHAPES
# =============================================================================

icac-stranger:InvolvesAbductorShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:involvesAbductor ;
    sh:name "involves abductor" ;
    sh:description "Links abduction to abductor profile" ;
    sh:class icac-stranger:AbductorProfile ;
    sh:minCount 1 ;
    sh:maxCount 1 .

icac-stranger:UsesMethodShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:usesMethod ;
    sh:name "uses method" ;
    sh:description "Links abduction to method used" ;
    sh:class icac-stranger:AbductionMethod ;
    sh:minCount 1 ;
    sh:maxCount 1 .

icac-stranger:TriggersSearchShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:triggersSearch ;
    sh:name "triggers search" ;
    sh:description "Links abduction to search operations" ;
    sh:class icac-stranger:SearchOperation ;
    sh:minCount 0 .

icac-stranger:ActivatesAlertShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:activatesAlert ;
    sh:name "activates alert" ;
    sh:description "Links abduction to Amber Alert" ;
    sh:class icac-stranger:AmberAlert ;
    sh:minCount 0 ;
    sh:maxCount 1 .

icac-stranger:ResultsInRecoveryShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:resultsInRecovery ;
    sh:name "results in recovery" ;
    sh:description "Links abduction to victim recovery" ;
    sh:class icac-stranger:VictimRecovery ;
    sh:minCount 0 ;
    sh:maxCount 1 .

icac-stranger:MeetsAlertCriteriaShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:meetsAlertCriteria ;
    sh:name "meets alert criteria" ;
    sh:description "Links Amber Alert to criteria" ;
    sh:class icac-stranger:AlertCriteria ;
    sh:minCount 1 .

icac-stranger:RequiresRescueShape rdf:type sh:PropertyShape ;
    sh:path icac-stranger:requiresRescue ;
    sh:name "requires rescue" ;
    sh:description "Links recovery to rescue operation" ;
    sh:class icac-stranger:RescueOperation ;
    sh:minCount 0 ;
    sh:maxCount 1 .

# =============================================================================
# CROSS-REFERENCE VALIDATION SHAPES
# =============================================================================

icac-stranger:AbductionCrossReferenceShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:StrangerAbduction ;
    rdfs:label "Abduction Cross Reference Shape"@en ;
    rdfs:comment "Validates cross-references between abduction and related entities."@en ;
    sh:sparql [
        sh:message "Stranger abduction must involve abductor and use method."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this a icac-stranger:StrangerAbduction .
                FILTER NOT EXISTS {
                    $this icac-stranger:involvesAbductor ?abductor ;
                          icac-stranger:usesMethod ?method .
                }
            }
        """
    ] .

icac-stranger:AmberAlertValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:AmberAlert ;
    rdfs:label "Amber Alert Validation Shape"@en ;
    rdfs:comment "Validates Amber Alert activation criteria."@en ;
    sh:sparql [
        sh:message "Amber Alert must meet all required criteria before activation."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this a icac-stranger:AmberAlert ;
                      icac-stranger:meetsAlertCriteria ?criteria .
                ?criteria icac-stranger:criteriaMet false .
            }
        """
    ] .

icac-stranger:SearchEffectivenessShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:SearchOperation ;
    rdfs:label "Search Effectiveness Shape"@en ;
    rdfs:comment "Validates search operation resource allocation."@en ;
    sh:sparql [
        sh:message "Large search operations should have adequate personnel."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-stranger:searchRadius ?radius ;
                      icac-stranger:personnelCount ?personnel .
                FILTER (?radius > 50.0 && ?personnel < 20)
            }
        """
    ] .

# =============================================================================
# TEMPORAL VALIDATION SHAPES
# =============================================================================

icac-stranger:TemporalValidationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:StrangerAbduction ;
    rdfs:label "Temporal Validation Shape"@en ;
    rdfs:comment "Validates temporal consistency in stranger abductions."@en ;
    sh:sparql [
        sh:message "Abduction time must be before or equal to reported time."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-stranger:abductionTime ?abduction ;
                      icac-stranger:reportedTime ?reported .
                FILTER (?abduction > ?reported)
            }
        """
    ] .

icac-stranger:SearchTimingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:SearchOperation ;
    rdfs:label "Search Timing Shape"@en ;
    rdfs:comment "Validates search operation timing."@en ;
    sh:sparql [
        sh:message "Search start time must be before end time when both are specified."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this uco-core:startTime ?start ;
                      uco-core:endTime ?end .
                FILTER (?start >= ?end)
            }
        """
    ] .

icac-stranger:AmberAlertTimingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:AmberAlert ;
    rdfs:label "Amber Alert Timing Shape"@en ;
    rdfs:comment "Validates Amber Alert timing consistency."@en ;
    sh:sparql [
        sh:message "Alert activation time must be before deactivation time when both are specified."@en ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-stranger:activationTime ?activation ;
                      icac-stranger:deactivationTime ?deactivation .
                FILTER (?activation >= ?deactivation)
            }
        """
    ] .

icac-stranger:RecoveryTimingShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:VictimRecovery ;
    rdfs:label "Recovery Timing Shape"@en ;
    rdfs:comment "Validates victim recovery timing consistency."@en ;
    sh:sparql [
        sh:message "Recovery time should be after abduction time."@en ;
        sh:select """
            SELECT $this
            WHERE {
                ?abduction icac-stranger:resultsInRecovery $this ;
                          icac-stranger:abductionTime ?abductionTime .
                $this icac-stranger:recoveryTime ?recoveryTime .
                FILTER (?recoveryTime <= ?abductionTime)
            }
        """
    ] .

# =============================================================================
# DATA QUALITY SHAPES
# =============================================================================

icac-stranger:DataQualityShape rdf:type sh:NodeShape ;
    sh:targetClass icac-stranger:StrangerAbduction ;
    rdfs:label "Data Quality Shape"@en ;
    rdfs:comment "Validates data quality for stranger abductions."@en ;
    sh:property [
        sh:path rdfs:label ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 5 ;
        sh:maxLength 200 ;
        sh:message "Label should be between 5 and 200 characters when provided."@en
    ] ;
    sh:property [
        sh:path rdfs:comment ;
        sh:datatype xsd:string ;
        sh:minCount 0 ;
        sh:maxCount 1 ;
        sh:minLength 10 ;
        sh:maxLength 1000 ;
        sh:message "Comment should be between 10 and 1000 characters when provided."@en
    ] . 