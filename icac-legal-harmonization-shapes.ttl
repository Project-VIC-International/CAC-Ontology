@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix gufo: <http://purl.org/nemo/gufo#> .
@prefix uco-core: <https://ontology.unifiedcyberontology.org/uco/core#> .
@prefix uco-identity: <https://ontology.unifiedcyberontology.org/uco/identity#> .
@prefix uco-action: <https://ontology.unifiedcyberontology.org/uco/action#> .
@prefix uco-location: <https://ontology.unifiedcyberontology.org/uco/location#> .
@prefix icac: <https://ontology.unifiedcyberontology.org/icac#> .
@prefix icac-legal: <https://ontology.unifiedcyberontology.org/icac/legal-harmonization#> .
@prefix icac-legal-shapes: <https://ontology.unifiedcyberontology.org/icac/legal-harmonization/shapes#> .

# =============================================================================
# ICAC LEGAL HARMONIZATION SHACL SHAPES
# Enhanced with gUFO (gentle Unified Foundational Ontology) integration
# =============================================================================

<https://ontology.unifiedcyberontology.org/icac/legal-harmonization-shapes> rdf:type owl:Ontology ;
    rdfs:label "ICAC Legal Harmonization SHACL Shapes"@en ;
    rdfs:comment "SHACL shapes for validating ICAC legal harmonization ontology instances with comprehensive gUFO integration for enhanced semantic validation, covering international legal frameworks, policy harmonization, and CSAM legislation analysis across 196 countries."@en ;
    owl:versionIRI <https://ontology.unifiedcyberontology.org/icac/legal-harmonization/shapes/1.1> ;
    owl:versionInfo "1.1.0" ;
    owl:imports <https://ontology.unifiedcyberontology.org/icac/legal-harmonization> ,
                <http://purl.org/nemo/gufo#> ,
                <http://www.w3.org/ns/shacl#> .

# =============================================================================
# gUFO TYPE CONSISTENCY VALIDATION SHAPES
# =============================================================================

icac-legal-shapes:LegalObjectTypeValidationShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Object Type Validation Shape"@en ;
    rdfs:comment "Validates that legal objects are properly classified as gUFO Objects and Kinds."@en ;
    sh:targetClass icac-legal:CSAMModelLaw ;
    sh:targetClass icac-legal:NationalLegislation ;
    sh:targetClass icac-legal:RegionalFramework ;
    sh:targetClass icac-legal:TreatyFramework ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Legal objects must be classified as gUFO Kind"@en
    ] ;
    sh:property [
        sh:path rdfs:subClassOf ;
        sh:qualifiedValueShape [
            sh:class gufo:Object
        ] ;
        sh:qualifiedMinCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Legal objects must extend gUFO Object"@en
    ] .

icac-legal-shapes:LegalProcessTypeValidationShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Process Type Validation Shape"@en ;
    rdfs:comment "Validates that legal processes are properly classified as gUFO Events and EventTypes."@en ;
    sh:targetClass icac-legal:PolicyHarmonization ;
    sh:targetClass icac-legal:LegalReform ;
    sh:targetClass icac-legal:PolicyDevelopment ;
    sh:targetClass icac-legal:InternationalLawEnforcement ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:EventType ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Legal processes must be classified as gUFO EventType"@en
    ] ;
    sh:property [
        sh:path rdfs:subClassOf ;
        sh:qualifiedValueShape [
            sh:class gufo:Event
        ] ;
        sh:qualifiedMinCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Legal processes must extend gUFO Event"@en
    ] ;
    sh:property [
        sh:path gufo:hasBeginPointInXSDDateTimeStamp ;
        sh:datatype xsd:dateTimeStamp ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Legal processes should have temporal boundaries"@en
    ] .

icac-legal-shapes:LegalSituationTypeValidationShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Situation Type Validation Shape"@en ;
    rdfs:comment "Validates that legal situations are properly classified as gUFO Situations and SituationTypes."@en ;
    sh:targetClass icac-legal:LegalCompliance ;
    sh:targetClass icac-legal:LegalSystemCompatibility ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:SituationType ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Legal situations must be classified as gUFO SituationType"@en
    ] ;
    sh:property [
        sh:path rdfs:subClassOf ;
        sh:qualifiedValueShape [
            sh:class gufo:Situation
        ] ;
        sh:qualifiedMinCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Legal situations must extend gUFO Situation"@en
    ] .

# =============================================================================
# gUFO TEMPORAL CONSTRAINTS SHAPES
# =============================================================================

icac-legal-shapes:LegalProcessTemporalShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Process Temporal Shape"@en ;
    rdfs:comment "Validates temporal constraints for legal processes according to gUFO framework."@en ;
    sh:targetClass icac-legal:LegalReform ;
    sh:targetClass icac-legal:PolicyDevelopment ;
    sh:targetClass icac-legal:PolicyHarmonization ;
    sh:property [
        sh:path gufo:hasBeginPointInXSDDateTimeStamp ;
        sh:datatype xsd:dateTimeStamp ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Legal processes should specify start time"@en
    ] ;
    sh:property [
        sh:path gufo:hasEndPointInXSDDateTimeStamp ;
        sh:datatype xsd:dateTimeStamp ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Legal processes should specify end time"@en
    ] ;
    sh:sparql [
        sh:message "Legal process end time must be after start time"@en ;
        sh:severity sh:Violation ;
        sh:prefixes [
            sh:declare [
                sh:prefix "gufo" ;
                sh:namespace "http://purl.org/nemo/gufo#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this gufo:hasBeginPointInXSDDateTimeStamp ?start .
                $this gufo:hasEndPointInXSDDateTimeStamp ?end .
                FILTER (?end <= ?start)
            }
        """
    ] .

icac-legal-shapes:LegalFrameworkTemporalShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Framework Temporal Shape"@en ;
    rdfs:comment "Validates temporal aspects of legal framework creation and evolution."@en ;
    sh:targetClass icac-legal:NationalLegislation ;
    sh:targetClass icac-legal:TreatyFramework ;
    sh:targetClass icac-legal:ExtraditionAgreement ;
    sh:property [
        sh:path uco-core:createdTime ;
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Legal frameworks should have creation timestamp"@en
    ] ;
    sh:property [
        sh:path uco-core:modifiedTime ;
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Legal frameworks may have modification timestamp"@en
    ] .

icac-legal-shapes:AssessmentTemporalShape rdf:type sh:NodeShape ;
    rdfs:label "Assessment Temporal Shape"@en ;
    rdfs:comment "Validates temporal constraints for legal assessments and reviews."@en ;
    sh:targetClass icac-legal:GlobalLegalReview ;
    sh:targetClass icac-legal:LegislativeAssessment ;
    sh:property [
        sh:path uco-core:startTime ;
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Assessments should specify start time"@en
    ] ;
    sh:property [
        sh:path uco-core:endTime ;
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Assessments should specify end time"@en
    ] ;
    sh:sparql [
        sh:message "Assessment end time must be after start time"@en ;
        sh:severity sh:Violation ;
        sh:prefixes [
            sh:declare [
                sh:prefix "uco-core" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/uco/core#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this uco-core:startTime ?start .
                $this uco-core:endTime ?end .
                FILTER (?end <= ?start)
            }
        """
    ] .

# =============================================================================
# ENHANCED DOMAIN-SPECIFIC SHAPES WITH gUFO QUALITY ASPECTS
# =============================================================================

icac-legal-shapes:CSAMModelLawShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:CSAMModelLaw ;
    rdfs:label "CSAM Model Law Shape"@en ;
    rdfs:comment "Enhanced validation shape for CSAM model legislation with gUFO quality aspects."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO Kind"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasLegalEffectiveness ;
        sh:datatype xsd:string ;
        sh:in ( "ineffective" "limited" "moderate" "effective" "highly_effective" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Legal effectiveness should be assessed"@en
    ] ;
    sh:property [
        sh:path icac-legal:hasDataQuality ;
        sh:datatype xsd:string ;
        sh:in ( "poor" "fair" "good" "excellent" "validated" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Data quality should be assessed"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path uco-core:name ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 5 ;
        sh:maxLength 200 ;
        rdfs:comment "Model law must have a descriptive name."@en ;
    ] ;
    sh:property [
        sh:path uco-core:description ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:minLength 50 ;
        sh:maxLength 2000 ;
        rdfs:comment "Model law must have detailed description."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:legalSystemType ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("common_law" "civil_law" "religious_law" "mixed" "universal") ;
        rdfs:comment "Legal system type for model law applicability."@en ;
    ] .

icac-legal-shapes:NationalLegislationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:NationalLegislation ;
    rdfs:label "National Legislation Shape"@en ;
    rdfs:comment "Enhanced shape for national legislation with implementation quality and effectiveness assessments."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO Kind"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasImplementationQuality ;
        sh:datatype xsd:string ;
        sh:in ( "poor" "fair" "good" "excellent" "exemplary" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Implementation quality should be assessed"@en
    ] ;
    sh:property [
        sh:path icac-legal:hasLegalEffectiveness ;
        sh:datatype xsd:string ;
        sh:in ( "ineffective" "limited" "moderate" "effective" "highly_effective" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Legal effectiveness should be assessed"@en
    ] ;
    sh:property [
        sh:path icac-legal:hasLegalRobustness ;
        sh:datatype xsd:string ;
        sh:in ( "weak" "moderate" "strong" "very_strong" "comprehensive" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Legal robustness should be assessed"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path icac-legal:implementationStatus ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ("drafted" "enacted" "enforced") ;
        rdfs:comment "Implementation status must be specified."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:legalSystemType ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in ("common_law" "civil_law" "religious_law" "mixed") ;
        rdfs:comment "Legal system type classification."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:appliesToCountry ;
        sh:class uco-location:Location ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        rdfs:comment "National legislation must apply to exactly one country."@en ;
    ] .

icac-legal-shapes:PolicyHarmonizationShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:PolicyHarmonization ;
    rdfs:label "Policy Harmonization Shape"@en ;
    rdfs:comment "Enhanced shape for policy harmonization with harmonization degree assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:EventType ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO EventType"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasHarmonizationDegree ;
        sh:datatype xsd:string ;
        sh:in ( "minimal" "partial" "substantial" "comprehensive" "complete" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Harmonization degree should be assessed"@en
    ] .

icac-legal-shapes:LegalReformShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:LegalReform ;
    rdfs:label "Legal Reform Shape"@en ;
    rdfs:comment "Enhanced shape for legal reform processes with urgency assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:EventType ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO EventType"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasReformUrgency ;
        sh:datatype xsd:string ;
        sh:in ( "low" "moderate" "high" "urgent" "critical" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Reform urgency should be assessed"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path icac-legal:reformPriority ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ("low" "medium" "high" "urgent") ;
        rdfs:comment "Reform priority must be specified."@en ;
    ] ;
    sh:property [
        sh:path uco-core:name ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:pattern ".*Reform.*" ;
        rdfs:comment "Reform name must contain 'Reform'."@en ;
    ] .

icac-legal-shapes:TreatyFrameworkShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:TreatyFramework ;
    rdfs:label "Treaty Framework Shape"@en ;
    rdfs:comment "Enhanced shape for international treaty frameworks with strength assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO Kind"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasTreatyStrength ;
        sh:datatype xsd:string ;
        sh:in ( "weak" "moderate" "strong" "binding" "comprehensive" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Treaty strength should be assessed"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path uco-core:name ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minLength 15 ;
        sh:maxLength 300 ;
        rdfs:comment "Treaty framework must have comprehensive name."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:facilitatesCooperation ;
        sh:class icac-legal:InternationalLawEnforcement ;
        sh:minCount 1 ;
        rdfs:comment "Treaty must facilitate international cooperation."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:appliesToCountry ;
        sh:class uco-location:Location ;
        sh:minCount 3 ;
        rdfs:comment "Multilateral treaty must apply to at least three countries."@en ;
    ] .

icac-legal-shapes:InternationalLawEnforcementShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:InternationalLawEnforcement ;
    rdfs:label "International Law Enforcement Shape"@en ;
    rdfs:comment "Enhanced shape for international law enforcement with cooperation intensity assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:EventType ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO EventType"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasCooperationIntensity ;
        sh:datatype xsd:string ;
        sh:in ( "minimal" "moderate" "substantial" "intensive" "comprehensive" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Cooperation intensity should be assessed"@en
    ] .

icac-legal-shapes:LegalComplianceShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:LegalCompliance ;
    rdfs:label "Legal Compliance Shape"@en ;
    rdfs:comment "Enhanced shape for legal compliance situations with compliance level assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:SituationType ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO SituationType"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasComplianceLevel ;
        sh:datatype xsd:double ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Compliance level should be measured (0.0-1.0)"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path icac-legal:legalAlignmentLevel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ("none" "partial" "substantial" "full") ;
        rdfs:comment "Legal alignment level must be specified."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:measuredBy ;
        sh:class icac-legal:ComplianceMetrics ;
        sh:minCount 1 ;
        rdfs:comment "Compliance must be measured by specific metrics."@en ;
    ] .

icac-legal-shapes:LegalFrameworkGapShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:LegalFrameworkGap ;
    rdfs:label "Legal Framework Gap Shape"@en ;
    rdfs:comment "Enhanced shape for legal framework gaps with gap severity assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO Kind"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasGapSeverity ;
        sh:datatype xsd:string ;
        sh:in ( "minor" "moderate" "major" "critical" "systemic" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Gap severity should be assessed"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path icac-legal:policyGapSeverity ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in ("minor" "moderate" "major" "critical") ;
        rdfs:comment "Gap severity must be specified."@en ;
    ] ;
    sh:property [
        sh:path uco-core:description ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:minLength 20 ;
        sh:maxLength 1000 ;
        rdfs:comment "Gap must have detailed description."@en ;
    ] ;
    sh:property [
        sh:path icac-legal:requiresReform ;
        sh:class icac-legal:LegalReform ;
        sh:minCount 1 ;
        rdfs:comment "Gap must require specific legal reform."@en ;
    ] .

icac-legal-shapes:LegislativeAssessmentShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:LegislativeAssessment ;
    rdfs:label "Legislative Assessment Shape"@en ;
    rdfs:comment "Enhanced shape for legislative assessments with reliability assessment."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO Kind"@en
    ] ;
    # gUFO Quality Aspects
    sh:property [
        sh:path icac-legal:hasAssessmentReliability ;
        sh:datatype xsd:double ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Assessment reliability should be measured"@en
    ] ;
    sh:property [
        sh:path icac-legal:hasDataQuality ;
        sh:datatype xsd:string ;
        sh:in ( "poor" "fair" "good" "excellent" "validated" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Data quality should be assessed"@en
    ] ;
    # Standard Properties
    sh:property [
        sh:path icac-legal:legislativeCompliance ;
        sh:datatype xsd:decimal ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 0.0 ;
        sh:maxInclusive 1.0 ;
        rdfs:comment "Compliance score must be between 0.0 and 1.0."@en ;
    ] ;
    sh:property [
        sh:path uco-core:createdTime ;
        sh:datatype xsd:dateTime ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        rdfs:comment "Assessment must have creation timestamp."@en ;
    ] .

# =============================================================================
# gUFO PARTICIPATION CONSTRAINT SHAPES
# =============================================================================

icac-legal-shapes:LegalHarmonizationParticipationShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Harmonization Participation Shape"@en ;
    rdfs:comment "Validates participation constraints for legal harmonization activities following gUFO participation patterns."@en ;
    sh:targetClass icac-legal:PolicyHarmonization ;
    sh:property [
        sh:path [ sh:inversePath icac-legal:participatesIn ] ;
        sh:class uco-location:Location ;
        sh:minCount 2 ;
        sh:severity sh:Violation ;
        sh:message "Policy harmonization must involve at least two countries"@en
    ] .

icac-legal-shapes:InternationalCooperationParticipationShape rdf:type sh:NodeShape ;
    rdfs:label "International Cooperation Participation Shape"@en ;
    rdfs:comment "Validates participation constraints for international law enforcement cooperation."@en ;
    sh:targetClass icac-legal:InternationalLawEnforcement ;
    sh:property [
        sh:path [ sh:inversePath icac-legal:participatesIn ] ;
        sh:class uco-identity:Organization ;
        sh:minCount 2 ;
        sh:severity sh:Warning ;
        sh:message "International cooperation should involve multiple organizations"@en
    ] .

icac-legal-shapes:TechnicalAssistanceParticipationShape rdf:type sh:NodeShape ;
    rdfs:label "Technical Assistance Participation Shape"@en ;
    rdfs:comment "Validates participation of organizations in technical assistance programs."@en ;
    sh:targetClass icac-legal:TechnicalAssistance ;
    sh:property [
        sh:path [ sh:inversePath icac-legal:participatesIn ] ;
        sh:class uco-identity:Organization ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Technical assistance must involve at least one organization"@en
    ] .

# =============================================================================
# gUFO PART-WHOLE RELATIONSHIP SHAPES
# =============================================================================

icac-legal-shapes:LegalFrameworkCompositionShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Framework Composition Shape"@en ;
    rdfs:comment "Validates compositional structure of legal frameworks following gUFO part-whole patterns."@en ;
    sh:targetClass icac-legal:RegionalFramework ;
    sh:property [
        sh:path [ sh:inversePath icac-legal:isComponentOf ] ;
        sh:class icac-legal:NationalLegislation ;
        sh:minCount 3 ;
        sh:severity sh:Violation ;
        sh:message "Regional framework must include legislation from at least three countries"@en
    ] .

icac-legal-shapes:TreatyFrameworkCompositionShape rdf:type sh:NodeShape ;
    rdfs:label "Treaty Framework Composition Shape"@en ;
    rdfs:comment "Validates compositional structure of treaty frameworks."@en ;
    sh:targetClass icac-legal:TreatyFramework ;
    sh:property [
        sh:path [ sh:inversePath icac-legal:isComponentOf ] ;
        sh:class icac-legal:NationalLegislation ;
        sh:minCount 2 ;
        sh:severity sh:Warning ;
        sh:message "Treaty framework should include implementing legislation from member countries"@en
    ] .

# =============================================================================
# gUFO QUALIFIED RELATION SHAPES
# =============================================================================

icac-legal-shapes:QualifiedComplianceParticipationShape rdf:type sh:NodeShape ;
    rdfs:label "Qualified Compliance Participation Shape"@en ;
    rdfs:comment "Validates qualified participation relationships in legal compliance according to gUFO patterns."@en ;
    sh:targetClass gufo:ParticipationSituation ;
    sh:property [
        sh:path icac-legal:concernsLegalFramework ;
        sh:class icac-legal:NationalLegislation ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Participation situation must concern exactly one legal framework"@en
    ] .

# =============================================================================
# ADVANCED gUFO BUSINESS RULES
# =============================================================================

icac-legal-shapes:HighEffectivenessLegislationRule rdf:type sh:NodeShape ;
    rdfs:label "High Effectiveness Legislation Rule"@en ;
    rdfs:comment "Highly effective legislation should have excellent implementation quality."@en ;
    sh:targetClass icac-legal:NationalLegislation ;
    sh:sparql [
        sh:message "Highly effective legislation should have excellent implementation quality"@en ;
        sh:severity sh:Warning ;
        sh:prefixes [
            sh:declare [
                sh:prefix "icac-legal" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/icac/legal-harmonization#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-legal:hasLegalEffectiveness "highly_effective" .
                OPTIONAL {
                    $this icac-legal:hasImplementationQuality ?quality .
                    FILTER (?quality IN ("excellent", "exemplary"))
                }
                FILTER (!BOUND(?quality))
            }
        """
    ] .

icac-legal-shapes:ComprehensiveHarmonizationRule rdf:type sh:NodeShape ;
    rdfs:label "Comprehensive Harmonization Rule"@en ;
    rdfs:comment "Comprehensive harmonization should involve strong treaty frameworks."@en ;
    sh:targetClass icac-legal:PolicyHarmonization ;
    sh:sparql [
        sh:message "Comprehensive harmonization should involve strong treaty frameworks"@en ;
        sh:severity sh:Warning ;
        sh:prefixes [
            sh:declare [
                sh:prefix "icac-legal" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/icac/legal-harmonization#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-legal:hasHarmonizationDegree ?degree .
                FILTER (?degree IN ("comprehensive", "complete"))
                OPTIONAL {
                    ?treaty icac-legal:facilitatesCooperation ?cooperation .
                    ?cooperation rdf:type icac-legal:InternationalLawEnforcement .
                    ?treaty icac-legal:hasTreatyStrength ?strength .
                    FILTER (?strength IN ("binding", "comprehensive"))
                }
                FILTER (!BOUND(?strength))
            }
        """
    ] .

icac-legal-shapes:CriticalGapReformRule rdf:type sh:NodeShape ;
    rdfs:label "Critical Gap Reform Rule"@en ;
    rdfs:comment "Critical gaps should require urgent reform."@en ;
    sh:targetClass icac-legal:LegalFrameworkGap ;
    sh:sparql [
        sh:message "Critical gaps should require urgent reform"@en ;
        sh:severity sh:Warning ;
        sh:prefixes [
            sh:declare [
                sh:prefix "icac-legal" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/icac/legal-harmonization#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-legal:hasGapSeverity ?severity .
                FILTER (?severity IN ("critical", "systemic"))
                OPTIONAL {
                    $this icac-legal:requiresReform ?reform .
                    ?reform icac-legal:hasReformUrgency ?urgency .
                    FILTER (?urgency IN ("urgent", "critical"))
                }
                FILTER (!BOUND(?urgency))
            }
        """
    ] .

icac-legal-shapes:FullComplianceAlignmentRule rdf:type sh:NodeShape ;
    rdfs:label "Full Compliance Alignment Rule"@en ;
    rdfs:comment "Full legal alignment should have high compliance levels."@en ;
    sh:targetClass icac-legal:LegalCompliance ;
    sh:sparql [
        sh:message "Full legal alignment should have high compliance levels"@en ;
        sh:severity sh:Warning ;
        sh:prefixes [
            sh:declare [
                sh:prefix "icac-legal" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/icac/legal-harmonization#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-legal:legalAlignmentLevel "full" .
                OPTIONAL {
                    $this icac-legal:hasComplianceLevel ?level .
                    FILTER (?level >= 0.8)
                }
                FILTER (!BOUND(?level))
            }
        """
    ] .

icac-legal-shapes:InternationalCooperationFrameworkRule rdf:type sh:NodeShape ;
    rdfs:label "International Cooperation Framework Rule"@en ;
    rdfs:comment "International law enforcement must be supported by proper legal framework."@en ;
    sh:targetClass icac-legal:InternationalLawEnforcement ;
    sh:sparql [
        sh:message "International law enforcement must be supported by treaty or extradition framework"@en ;
        sh:severity sh:Violation ;
        sh:prefixes [
            sh:declare [
                sh:prefix "icac-legal" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/icac/legal-harmonization#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this a icac-legal:InternationalLawEnforcement .
                FILTER NOT EXISTS {
                    { ?treaty icac-legal:facilitatesCooperation $this . }
                    UNION
                    { ?agreement icac-legal:enablesExtradition $this . }
                }
            }
        """
    ] .

# =============================================================================
# ENHANCED gUFO DATA QUALITY VALIDATION SHAPE
# =============================================================================

icac-legal-shapes:LegalHarmonizationDataQualityShape rdf:type sh:NodeShape ;
    rdfs:label "Legal Harmonization Data Quality Shape"@en ;
    rdfs:comment "Comprehensive gUFO quality validation for legal harmonization data."@en ;
    sh:targetClass icac-legal:GlobalLegalReview ;
    sh:targetClass icac-legal:LegislativeAssessment ;
    sh:targetClass icac-legal:ComplianceMetrics ;
    # gUFO Quality Level Validation
    sh:property [
        sh:path icac-legal:hasDataQuality ;
        sh:datatype xsd:string ;
        sh:in ( "poor" "fair" "good" "excellent" "validated" ) ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Data quality level should be assessed"@en
    ] ;
    # Quality consistency rule
    sh:sparql [
        sh:message "Excellent data quality should have high assessment reliability"@en ;
        sh:severity sh:Warning ;
        sh:prefixes [
            sh:declare [
                sh:prefix "icac-legal" ;
                sh:namespace "https://ontology.unifiedcyberontology.org/icac/legal-harmonization#"^^xsd:anyURI
            ]
        ] ;
        sh:select """
            SELECT $this
            WHERE {
                $this icac-legal:hasDataQuality "excellent" .
                OPTIONAL {
                    $this icac-legal:hasAssessmentReliability ?reliability .
                    FILTER (?reliability >= 0.8)
                }
                FILTER (!BOUND(?reliability))
            }
        """
    ] .

# =============================================================================
# ORIGINAL VALIDATION SHAPES (ENHANCED)
# =============================================================================

icac-legal-shapes:GlobalLegalReviewShape rdf:type sh:NodeShape ;
    sh:targetClass icac-legal:GlobalLegalReview ;
    rdfs:label "Global Legal Review Shape"@en ;
    rdfs:comment "Enhanced validation shape for global legal reviews with gUFO integration."@en ;
    sh:property [
        sh:path rdf:type ;
        sh:hasValue gufo:Kind ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Must be classified as gUFO Kind"@en
    ] ;
    sh:property [
        sh:path icac-legal:countriesAnalyzed ;
        sh:datatype xsd:nonNegativeInteger ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minInclusive 1 ;
        sh:maxInclusive 196 ;
        rdfs:comment "Number of countries analyzed (1-196)."@en ;
    ] ;
    sh:property [
        sh:path uco-core:name ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:pattern "^Global.*Review.*[0-9]{4}$" ;
        rdfs:comment "Review name must include 'Global', 'Review', and year."@en ;
    ] . 